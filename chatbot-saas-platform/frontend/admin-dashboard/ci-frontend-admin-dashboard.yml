trigger:
  branches:
    include:
      - dev

  paths:
    include:
      - chatbot-saas-platform/frontend/admin-dashboard/**

pool:
  name: ubuntu-22.04

variables:
  workingDirectory: "chatbot-saas-platform/frontend/admin-dashboard"
  artifactName: "admin-dashboard"

steps:
  #  Use Node 22
  - task: NodeTool@0
    inputs:
      versionSpec: "22.x"
    displayName: "Use Node.js 22"

  # Install & build frontend (staging)
  - task: Npm@1
    displayName: Install & build frontend (staging)
    inputs:
      command: custom
      customCommand: "ci && npm run build:staging"
    workingDirectory: "frontend/admin-dashboard"

  # Publish build artifacts
  - task: PublishBuildArtifacts@1
    inputs:
      PathtoPublish: "$(workingDirectory)/dist"
      ArtifactName: $(artifactName)
      publishLocation: "Container"
    displayName: "Publish Build Artifacts"
