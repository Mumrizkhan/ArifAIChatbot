!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("react"),require("react-dom")):"function"==typeof define&&define.amd?define(["react","react-dom"],t):(e="undefined"!=typeof globalThis?globalThis:e||self).ArifChatWidget=t(e.React,e.ReactDOM)}(this,function(e,t){"use strict";var n=Object.defineProperty,r=Object.defineProperties,o=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,c=(e,t,r)=>t in e?n(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,l=(e,t)=>{for(var n in t||(t={}))i.call(t,n)&&c(e,n,t[n]);if(s)for(var n of s(t))a.call(t,n)&&c(e,n,t[n]);return e},u=(e,t)=>r(e,o(t)),d=(e,t)=>{var n={};for(var r in e)i.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&s)for(var r of s(e))t.indexOf(r)<0&&a.call(e,r)&&(n[r]=e[r]);return n},p=(e,t,n)=>c(e,"symbol"!=typeof t?t+"":t,n),h=(e,t,n)=>new Promise((r,o)=>{var s=e=>{try{a(n.next(e))}catch(t){o(t)}},i=e=>{try{a(n.throw(e))}catch(t){o(t)}},a=e=>e.done?r(e.value):Promise.resolve(e.value).then(s,i);a((n=n.apply(e,t)).next())});function f(e){const t=Object.create(null,{[Symbol.toStringTag]:{value:"Module"}});if(e)for(const n in e)if("default"!==n){const r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:()=>e[n]})}return t.default=e,Object.freeze(t)}const g=f(e);function m(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var y,v={};const b=m(function(){if(y)return v;y=1;var e=t;if("production"===process.env.NODE_ENV)v.createRoot=e.createRoot,v.hydrateRoot=e.hydrateRoot;else{var n=e.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;v.createRoot=function(t,r){n.usingClientEntryPoint=!0;try{return e.createRoot(t,r)}finally{n.usingClientEntryPoint=!1}},v.hydrateRoot=function(t,r,o){n.usingClientEntryPoint=!0;try{return e.hydrateRoot(t,r,o)}finally{n.usingClientEntryPoint=!1}}}return v}());var w,x,S,N={exports:{}},E={},O={},k=(S||(S=1,"production"===process.env.NODE_ENV?N.exports=function(){if(w)return E;w=1;var t=e,n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=t.useSyncExternalStore,o=t.useRef,s=t.useEffect,i=t.useMemo,a=t.useDebugValue;return E.useSyncExternalStoreWithSelector=function(e,t,c,l,u){var d=o(null);if(null===d.current){var p={hasValue:!1,value:null};d.current=p}else p=d.current;d=i(function(){function e(e){if(!s){if(s=!0,r=e,e=l(e),void 0!==u&&p.hasValue){var t=p.value;if(u(t,e))return o=t}return o=e}if(t=o,n(r,e))return t;var i=l(e);return void 0!==u&&u(t,i)?(r=e,t):(r=e,o=i)}var r,o,s=!1,i=void 0===c?null:c;return[function(){return e(t())},null===i?void 0:function(){return e(i())}]},[t,c,l,u]);var h=r(e,d[0],d[1]);return s(function(){p.hasValue=!0,p.value=h},[h]),a(h),h},E}():N.exports=(x||(x=1,"production"!==process.env.NODE_ENV&&function(){"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var t=e,n="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},r=t.useSyncExternalStore,o=t.useRef,s=t.useEffect,i=t.useMemo,a=t.useDebugValue;O.useSyncExternalStoreWithSelector=function(e,t,c,l,u){var d=o(null);if(null===d.current){var p={hasValue:!1,value:null};d.current=p}else p=d.current;d=i(function(){function e(e){if(!s){if(s=!0,r=e,e=l(e),void 0!==u&&p.hasValue){var t=p.value;if(u(t,e))return o=t}return o=e}if(t=o,n(r,e))return t;var i=l(e);return void 0!==u&&u(t,i)?(r=e,t):(r=e,o=i)}var r,o,s=!1,i=void 0===c?null:c;return[function(){return e(t())},null===i?void 0:function(){return e(i())}]},[t,c,l,u]);var h=r(e,d[0],d[1]);return s(function(){p.hasValue=!0,p.value=h},[h]),a(h),h},"undefined"!=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}()),O)),N.exports),j={notify(){},get:()=>[]},C=(()=>!("undefined"==typeof window||void 0===window.document||void 0===window.document.createElement))(),_=(()=>"undefined"!=typeof navigator&&"ReactNative"===navigator.product)(),M=(()=>C||_?g.useLayoutEffect:g.useEffect)(),R=Symbol.for("react-redux-context"),T="undefined"!=typeof globalThis?globalThis:{};function P(){var e;if(!g.createContext)return{};const t=null!=(e=T[R])?e:T[R]=new Map;let n=t.get(g.createContext);return n||(n=g.createContext(null),"production"!==process.env.NODE_ENV&&(n.displayName="ReactRedux"),t.set(g.createContext,n)),n}var D=P(),L=function(e){const{children:t,context:n,serverState:r,store:o}=e,s=g.useMemo(()=>{const t=function(e){let t,n=j,r=0,o=!1;function s(){c.onStateChange&&c.onStateChange()}function i(){r++,t||(t=e.subscribe(s),n=function(){let e=null,t=null;return{clear(){e=null,t=null},notify(){(()=>{let t=e;for(;t;)t.callback(),t=t.next})()},get(){const t=[];let n=e;for(;n;)t.push(n),n=n.next;return t},subscribe(n){let r=!0;const o=t={callback:n,next:null,prev:t};return o.prev?o.prev.next=o:e=o,function(){r&&null!==e&&(r=!1,o.next?o.next.prev=o.prev:t=o.prev,o.prev?o.prev.next=o.next:e=o.next)}}}}())}function a(){r--,t&&0===r&&(t(),t=void 0,n.clear(),n=j)}const c={addNestedSub:function(e){i();const t=n.subscribe(e);let r=!1;return()=>{r||(r=!0,t(),a())}},notifyNestedSubs:function(){n.notify()},handleChangeWrapper:s,isSubscribed:function(){return o},trySubscribe:function(){o||(o=!0,i())},tryUnsubscribe:function(){o&&(o=!1,a())},getListeners:()=>n};return c}(o),n={store:o,subscription:t,getServerState:r?()=>r:void 0};if("production"===process.env.NODE_ENV)return n;{const{identityFunctionCheck:t="once",stabilityCheck:r="once"}=e;return Object.assign(n,{stabilityCheck:r,identityFunctionCheck:t})}},[o,r]),i=g.useMemo(()=>o.getState(),[o]);M(()=>{const{subscription:e}=s;return e.onStateChange=e.notifyNestedSubs,e.trySubscribe(),i!==o.getState()&&e.notifyNestedSubs(),()=>{e.tryUnsubscribe(),e.onStateChange=void 0}},[s,i]);const a=n||D;return g.createElement(a.Provider,{value:s},t)};function I(e=D){return function(){const t=g.useContext(e);if("production"!==process.env.NODE_ENV&&!t)throw new Error("could not find react-redux context value; please ensure the component is wrapped in a <Provider>");return t}}var $=I();function z(e=D){const t=e===D?$:I(e),n=()=>{const{store:e}=t();return e};return Object.assign(n,{withTypes:()=>n}),n}var A=z();function F(e=D){const t=e===D?A:z(e),n=()=>t().dispatch;return Object.assign(n,{withTypes:()=>n}),n}var V=F(),U=(e,t)=>e===t;function W(e=D){const t=e===D?$:I(e),n=(e,n={})=>{const{equalityFn:r=U}="function"==typeof n?{equalityFn:n}:n;if("production"!==process.env.NODE_ENV){if(!e)throw new Error("You must pass a selector to useSelector");if("function"!=typeof e)throw new Error("You must pass a function as a selector to useSelector");if("function"!=typeof r)throw new Error("You must pass a function as an equality function to useSelector")}const o=t(),{store:s,subscription:i,getServerState:a}=o,c=g.useRef(!0),u=g.useCallback({[e.name](t){const s=e(t);if("production"!==process.env.NODE_ENV){const{devModeChecks:a={}}="function"==typeof n?{}:n,{identityFunctionCheck:u,stabilityCheck:d}=o,{identityFunctionCheck:p,stabilityCheck:h}=l({stabilityCheck:d,identityFunctionCheck:u},a);if("always"===h||"once"===h&&c.current){const n=e(t);if(!r(s,n)){let e;try{throw new Error}catch(i){({stack:e}=i)}}}if(("always"===p||"once"===p&&c.current)&&s===t){let e;try{throw new Error}catch(i){({stack:e}=i)}}c.current&&(c.current=!1)}return s}}[e.name],[e]),d=k.useSyncExternalStoreWithSelector(i.addNestedSub,s.getState,a||s.getState,u,r);return g.useDebugValue(d),d};return Object.assign(n,{withTypes:()=>n}),n}var B=W();function q(e){return`Minified Redux error #${e}; visit https://redux.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}var H=(()=>"function"==typeof Symbol&&Symbol.observable||"@@observable")(),K=()=>Math.random().toString(36).substring(7).split("").join("."),J={INIT:`@@redux/INIT${K()}`,REPLACE:`@@redux/REPLACE${K()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${K()}`};function Y(e){if("object"!=typeof e||null===e)return!1;let t=e;for(;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t||null===Object.getPrototypeOf(e)}function X(e){let t=typeof e;return"production"!==process.env.NODE_ENV&&(t=function(e){if(void 0===e)return"undefined";if(null===e)return"null";const t=typeof e;switch(t){case"boolean":case"string":case"number":case"symbol":case"function":return t}if(Array.isArray(e))return"array";if(function(e){return e instanceof Date||"function"==typeof e.toDateString&&"function"==typeof e.getDate&&"function"==typeof e.setDate}(e))return"date";if(function(e){return e instanceof Error||"string"==typeof e.message&&e.constructor&&"number"==typeof e.constructor.stackTraceLimit}(e))return"error";const n=function(e){return"function"==typeof e.constructor?e.constructor.name:null}(e);switch(n){case"Symbol":case"Promise":case"WeakMap":case"WeakSet":case"Map":case"Set":return n}return Object.prototype.toString.call(e).slice(8,-1).toLowerCase().replace(/\s/g,"")}(e)),t}function G(e,t,n){if("function"!=typeof e)throw new Error("production"===process.env.NODE_ENV?q(2):`Expected the root reducer to be a function. Instead, received: '${X(e)}'`);if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("production"===process.env.NODE_ENV?q(0):"It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function. See https://redux.js.org/tutorials/fundamentals/part-4-store#creating-a-store-with-enhancers for an example.");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("production"===process.env.NODE_ENV?q(1):`Expected the enhancer to be a function. Instead, received: '${X(n)}'`);return n(G)(e,t)}let r=e,o=t,s=new Map,i=s,a=0,c=!1;function l(){i===s&&(i=new Map,s.forEach((e,t)=>{i.set(t,e)}))}function u(){if(c)throw new Error("production"===process.env.NODE_ENV?q(3):"You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return o}function d(e){if("function"!=typeof e)throw new Error("production"===process.env.NODE_ENV?q(4):`Expected the listener to be a function. Instead, received: '${X(e)}'`);if(c)throw new Error("production"===process.env.NODE_ENV?q(5):"You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api/store#subscribelistener for more details.");let t=!0;l();const n=a++;return i.set(n,e),function(){if(t){if(c)throw new Error("production"===process.env.NODE_ENV?q(6):"You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api/store#subscribelistener for more details.");t=!1,l(),i.delete(n),s=null}}}function p(e){if(!Y(e))throw new Error("production"===process.env.NODE_ENV?q(7):`Actions must be plain objects. Instead, the actual type was: '${X(e)}'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.`);if(void 0===e.type)throw new Error("production"===process.env.NODE_ENV?q(8):'Actions may not have an undefined "type" property. You may have misspelled an action type string constant.');if("string"!=typeof e.type)throw new Error("production"===process.env.NODE_ENV?q(17):`Action "type" property must be a string. Instead, the actual type was: '${X(e.type)}'. Value was: '${e.type}' (stringified)`);if(c)throw new Error("production"===process.env.NODE_ENV?q(9):"Reducers may not dispatch actions.");try{c=!0,o=r(o,e)}finally{c=!1}return(s=i).forEach(e=>{e()}),e}return p({type:J.INIT}),{dispatch:p,subscribe:d,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error("production"===process.env.NODE_ENV?q(10):`Expected the nextReducer to be a function. Instead, received: '${X(e)}`);r=e,p({type:J.REPLACE})},[H]:function(){const e=d;return{subscribe(t){if("object"!=typeof t||null===t)throw new Error("production"===process.env.NODE_ENV?q(11):`Expected the observer to be an object. Instead, received: '${X(t)}'`);function n(){const e=t;e.next&&e.next(u())}return n(),{unsubscribe:e(n)}},[H](){return this}}}}}function Q(e){"undefined"!=typeof console&&console.error;try{throw new Error(e)}catch(t){}}function Z(...e){return 0===e.length?e=>e:1===e.length?e[0]:e.reduce((e,t)=>(...n)=>e(t(...n)))}function ee(e){return Y(e)&&"type"in e&&"string"==typeof e.type}var te=Symbol.for("immer-nothing"),ne=Symbol.for("immer-draftable"),re=Symbol.for("immer-state"),oe="production"!==process.env.NODE_ENV?[function(e){return`The plugin for '${e}' has not been loaded into Immer. To enable the plugin, import and call \`enable${e}()\` when initializing your application.`},function(e){return`produce can only be called on things that are draftable: plain objects, arrays, Map, Set or classes that are marked with '[immerable]: true'. Got '${e}'`},"This object has been frozen and should not be mutated",function(e){return"Cannot use a proxy that has been revoked. Did you pass an object from inside an immer function to an async process? "+e},"An immer producer returned a new value *and* modified its draft. Either return a new value *or* modify the draft.","Immer forbids circular references","The first or second argument to `produce` must be a function","The third argument to `produce` must be a function or undefined","First argument to `createDraft` must be a plain object, an array, or an immerable object","First argument to `finishDraft` must be a draft returned by `createDraft`",function(e){return`'current' expects a draft, got: ${e}`},"Object.defineProperty() cannot be used on an Immer draft","Object.setPrototypeOf() cannot be used on an Immer draft","Immer only supports deleting array indices","Immer only supports setting array indices and the 'length' property",function(e){return`'original' expects a draft, got: ${e}`}]:[];function se(e,...t){if("production"!==process.env.NODE_ENV){const n=oe[e],r="function"==typeof n?n.apply(null,t):n;throw new Error(`[Immer] ${r}`)}throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var ie=Object.getPrototypeOf;function ae(e){return!!e&&!!e[re]}function ce(e){var t;return!!e&&(ue(e)||Array.isArray(e)||!!e[ne]||!!(null==(t=e.constructor)?void 0:t[ne])||ge(e)||me(e))}var le=Object.prototype.constructor.toString();function ue(e){if(!e||"object"!=typeof e)return!1;const t=ie(e);if(null===t)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object||"function"==typeof n&&Function.toString.call(n)===le}function de(e,t){0===pe(e)?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function pe(e){const t=e[re];return t?t.type_:Array.isArray(e)?1:ge(e)?2:me(e)?3:0}function he(e,t){return 2===pe(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function fe(e,t,n){const r=pe(e);2===r?e.set(t,n):3===r?e.add(n):e[t]=n}function ge(e){return e instanceof Map}function me(e){return e instanceof Set}function ye(e){return e.copy_||e.base_}function ve(e,t){if(ge(e))return new Map(e);if(me(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=ue(e);if(!0===t||"class_only"===t&&!n){const t=Object.getOwnPropertyDescriptors(e);delete t[re];let n=Reflect.ownKeys(t);for(let r=0;r<n.length;r++){const o=n[r],s=t[o];!1===s.writable&&(s.writable=!0,s.configurable=!0),(s.get||s.set)&&(t[o]={configurable:!0,writable:!0,enumerable:s.enumerable,value:e[o]})}return Object.create(ie(e),t)}{const t=ie(e);if(null!==t&&n)return l({},e);const r=Object.create(t);return Object.assign(r,e)}}function be(e,t=!1){return xe(e)||ae(e)||!ce(e)||(pe(e)>1&&(e.set=e.add=e.clear=e.delete=we),Object.freeze(e),t&&Object.entries(e).forEach(([e,t])=>be(t,!0))),e}function we(){se(2)}function xe(e){return Object.isFrozen(e)}var Se,Ne={};function Ee(e){const t=Ne[e];return t||se(0,e),t}function Oe(){return Se}function ke(e,t){t&&(Ee("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function je(e){Ce(e),e.drafts_.forEach(Me),e.drafts_=null}function Ce(e){e===Se&&(Se=e.parent_)}function _e(e){return Se={drafts_:[],parent_:Se,immer_:e,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function Me(e){const t=e[re];0===t.type_||1===t.type_?t.revoke_():t.revoked_=!0}function Re(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return void 0!==e&&e!==n?(n[re].modified_&&(je(t),se(4)),ce(e)&&(e=Te(t,e),t.parent_||De(t,e)),t.patches_&&Ee("Patches").generateReplacementPatches_(n[re].base_,e,t.patches_,t.inversePatches_)):e=Te(t,n,[]),je(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==te?e:void 0}function Te(e,t,n){if(xe(t))return t;const r=t[re];if(!r)return de(t,(o,s)=>Pe(e,r,t,o,s,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return De(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const t=r.copy_;let o=t,s=!1;3===r.type_&&(o=new Set(t),t.clear(),s=!0),de(o,(o,i)=>Pe(e,r,t,o,i,n,s)),De(e,t,!1),n&&e.patches_&&Ee("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function Pe(e,t,n,r,o,s,i){if("production"!==process.env.NODE_ENV&&o===n&&se(5),ae(o)){const i=Te(e,o,s&&t&&3!==t.type_&&!he(t.assigned_,r)?s.concat(r):void 0);if(fe(n,r,i),!ae(i))return;e.canAutoFreeze_=!1}else i&&n.add(o);if(ce(o)&&!xe(o)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;Te(e,o),t&&t.scope_.parent_||"symbol"==typeof r||!Object.prototype.propertyIsEnumerable.call(n,r)||De(e,o)}}function De(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&be(t,n)}var Le={get(e,t){if(t===re)return e;const n=ye(e);if(!he(n,t))return function(e,t,n){var r;const o=ze(t,n);return o?"value"in o?o.value:null==(r=o.get)?void 0:r.call(e.draft_):void 0}(e,n,t);const r=n[t];return e.finalized_||!ce(r)?r:r===$e(e.base_,t)?(Fe(e),e.copy_[t]=Ve(r,e)):r},has:(e,t)=>t in ye(e),ownKeys:e=>Reflect.ownKeys(ye(e)),set(e,t,n){const r=ze(ye(e),t);if(null==r?void 0:r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const r=$e(ye(e),t),i=null==r?void 0:r[re];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(((o=n)===(s=r)?0!==o||1/o==1/s:o!=o&&s!=s)&&(void 0!==n||he(e.base_,t)))return!0;Fe(e),Ae(e)}var o,s;return e.copy_[t]===n&&(void 0!==n||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty:(e,t)=>(void 0!==$e(e.base_,t)||t in e.base_?(e.assigned_[t]=!1,Fe(e),Ae(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0),getOwnPropertyDescriptor(e,t){const n=ye(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.type_||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty(){se(11)},getPrototypeOf:e=>ie(e.base_),setPrototypeOf(){se(12)}},Ie={};function $e(e,t){const n=e[re];return(n?ye(n):e)[t]}function ze(e,t){if(!(t in e))return;let n=ie(e);for(;n;){const e=Object.getOwnPropertyDescriptor(n,t);if(e)return e;n=ie(n)}}function Ae(e){e.modified_||(e.modified_=!0,e.parent_&&Ae(e.parent_))}function Fe(e){e.copy_||(e.copy_=ve(e.base_,e.scope_.immer_.useStrictShallowCopy_))}function Ve(e,t){const n=ge(e)?Ee("MapSet").proxyMap_(e,t):me(e)?Ee("MapSet").proxySet_(e,t):function(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:Oe(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let o=r,s=Le;n&&(o=[r],s=Ie);const{revoke:i,proxy:a}=Proxy.revocable(o,s);return r.draft_=a,r.revoke_=i,a}(e,t);return(t?t.scope_:Oe()).drafts_.push(n),n}function Ue(e){if(!ce(e)||xe(e))return e;const t=e[re];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=ve(e,t.scope_.immer_.useStrictShallowCopy_)}else n=ve(e,!0);return de(n,(e,t)=>{fe(n,e,Ue(t))}),t&&(t.finalized_=!1),n}de(Le,(e,t)=>{Ie[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}}),Ie.deleteProperty=function(e,t){return"production"!==process.env.NODE_ENV&&isNaN(parseInt(t))&&se(13),Ie.set.call(this,e,t,void 0)},Ie.set=function(e,t,n){return"production"!==process.env.NODE_ENV&&"length"!==t&&isNaN(parseInt(t))&&se(14),Le.set.call(this,e[0],t,n,e[0])};var We=new class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(e,t,n)=>{if("function"==typeof e&&"function"!=typeof t){const n=t;t=e;const r=this;return function(e=n,...o){return r.produce(e,e=>t.call(this,e,...o))}}let r;if("function"!=typeof t&&se(6),void 0!==n&&"function"!=typeof n&&se(7),ce(e)){const o=_e(this),s=Ve(e,void 0);let i=!0;try{r=t(s),i=!1}finally{i?je(o):Ce(o)}return ke(o,n),Re(r,o)}if(!e||"object"!=typeof e){if(r=t(e),void 0===r&&(r=e),r===te&&(r=void 0),this.autoFreeze_&&be(r,!0),n){const t=[],o=[];Ee("Patches").generateReplacementPatches_(e,r,t,o),n(t,o)}return r}se(1,e)},this.produceWithPatches=(e,t)=>{if("function"==typeof e)return(t,...n)=>this.produceWithPatches(t,t=>e(t,...n));let n,r;return[this.produce(e,t,(e,t)=>{n=e,r=t}),n,r]},"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),"boolean"==typeof(null==e?void 0:e.useStrictShallowCopy)&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){var t;ce(e)||se(8),ae(e)&&(ae(t=e)||se(10,t),e=Ue(t));const n=_e(this),r=Ve(e,void 0);return r[re].isManual_=!0,Ce(n),r}finishDraft(e,t){const n=e&&e[re];n&&n.isManual_||se(9);const{scope_:r}=n;return ke(r,t),Re(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}n>-1&&(t=t.slice(n+1));const r=Ee("Patches").applyPatches_;return ae(e)?r(e,t):this.produce(e,e=>r(e,t))}},Be=We.produce;We.produceWithPatches.bind(We),We.setAutoFreeze.bind(We),We.setUseStrictShallowCopy.bind(We),We.applyPatches.bind(We),We.createDraft.bind(We),We.finishDraft.bind(We);var qe=(e,t,n)=>{if(1===t.length&&t[0]===n){let t=!1;try{const n={};e(n)===n&&(t=!0)}catch(r){}if(t){let e;try{throw new Error}catch(r){({stack:e}=r)}}}},He=(e,t,n)=>{const{memoize:r,memoizeOptions:o}=t,{inputSelectorResults:s,inputSelectorResultsCopy:i}=e,a=r(()=>({}),...o);if(a.apply(null,s)!==a.apply(null,i)){let e;try{throw new Error}catch(c){({stack:e}=c)}}},Ke={inputStabilityCheck:"once",identityFunctionCheck:"once"},Je=e=>Array.isArray(e)?e:[e];function Ye(e,t){const n=[],{length:r}=e;for(let o=0;o<r;o++)n.push(e[o].apply(null,t));return n}var Xe="undefined"!=typeof WeakRef?WeakRef:class{constructor(e){this.value=e}deref(){return this.value}};function Ge(){return{s:0,v:void 0,o:null,p:null}}function Qe(e,t={}){let n={s:0,v:void 0,o:null,p:null};const{resultEqualityCheck:r}=t;let o,s=0;function i(){var t,i;let a=n;const{length:c}=arguments;for(let e=0,n=c;e<n;e++){const t=arguments[e];if("function"==typeof t||"object"==typeof t&&null!==t){let e=a.o;null===e&&(a.o=e=new WeakMap);const n=e.get(t);void 0===n?(a=Ge(),e.set(t,a)):a=n}else{let e=a.p;null===e&&(a.p=e=new Map);const n=e.get(t);void 0===n?(a=Ge(),e.set(t,a)):a=n}}const l=a;let u;if(1===a.s)u=a.v;else if(u=e.apply(null,arguments),s++,r){const e=null!=(i=null==(t=null==o?void 0:o.deref)?void 0:t.call(o))?i:o;null!=e&&r(e,u)&&(u=e,0!==s&&s--),o="object"==typeof u&&null!==u||"function"==typeof u?new Xe(u):u}return l.s=1,l.v=u,u}return i.clearCache=()=>{n={s:0,v:void 0,o:null,p:null},i.resetResultsCount()},i.resultsCount=()=>s,i.resetResultsCount=()=>{s=0},i}function Ze(e,...t){const n="function"==typeof e?{memoize:e,memoizeOptions:t}:e,r=(...e)=>{let t,r=0,o=0,s={},i=e.pop();"object"==typeof i&&(s=i,i=e.pop()),function(e,t="expected a function, instead received "+typeof e){if("function"!=typeof e)throw new TypeError(t)}(i,`createSelector expects an output function after the inputs, but received: [${typeof i}]`);const a=l(l({},n),s),{memoize:c,memoizeOptions:u=[],argsMemoize:d=Qe,argsMemoizeOptions:p=[],devModeChecks:h={}}=a,f=Je(u),g=Je(p),m=function(e){const t=Array.isArray(e[0])?e[0]:e;return function(e,t="expected all items to be functions, instead received the following types: "){if(!e.every(e=>"function"==typeof e)){const n=e.map(e=>"function"==typeof e?`function ${e.name||"unnamed"}()`:typeof e).join(", ");throw new TypeError(`${t}[${n}]`)}}(t,"createSelector expects all input-selectors to be functions, but received the following types: "),t}(e),y=c(function(){return r++,i.apply(null,arguments)},...f);let v=!0;const b=d(function(){o++;const e=Ye(m,arguments);if(t=y.apply(null,e),"production"!==process.env.NODE_ENV){const{identityFunctionCheck:n,inputStabilityCheck:r}=((e,t)=>{const{identityFunctionCheck:n,inputStabilityCheck:r}=l(l({},Ke),t);return{identityFunctionCheck:{shouldRun:"always"===n||"once"===n&&e,run:qe},inputStabilityCheck:{shouldRun:"always"===r||"once"===r&&e,run:He}}})(v,h);if(n.shouldRun&&n.run(i,e,t),r.shouldRun){const t=Ye(m,arguments);r.run({inputSelectorResults:e,inputSelectorResultsCopy:t},{memoize:c,memoizeOptions:f},arguments)}v&&(v=!1)}return t},...g);return Object.assign(b,{resultFunc:i,memoizedResultFunc:y,dependencies:m,dependencyRecomputations:()=>o,resetDependencyRecomputations:()=>{o=0},lastResult:()=>t,recomputations:()=>r,resetRecomputations:()=>{r=0},memoize:c,argsMemoize:d})};return Object.assign(r,{withTypes:()=>r}),r}var et=Ze(Qe),tt=Object.assign((e,t=et)=>{!function(e,t="expected an object, instead received "+typeof e){if("object"!=typeof e)throw new TypeError(t)}(e,"createStructuredSelector expects first argument to be an object where each property is a selector, instead received a "+typeof e);const n=Object.keys(e);return t(n.map(t=>e[t]),(...e)=>e.reduce((e,t,r)=>(e[n[r]]=t,e),{}))},{withTypes:()=>tt});function nt(e){return({dispatch:t,getState:n})=>r=>o=>"function"==typeof o?o(t,n,e):r(o)}var rt=nt(),ot=nt,st="undefined"!=typeof window&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(0!==arguments.length)return"object"==typeof arguments[0]?Z:Z.apply(null,arguments)},it=e=>e&&"function"==typeof e.match;function at(e,t){function n(...n){if(t){let r=t(...n);if(!r)throw new Error("production"===process.env.NODE_ENV?zt(0):"prepareAction did not return an object");return l(l({type:e,payload:r.payload},"meta"in r&&{meta:r.meta}),"error"in r&&{error:r.error})}return{type:e,payload:n[0]}}return n.toString=()=>`${e}`,n.type=e,n.match=t=>ee(t)&&t.type===e,n}function ct(e){return"function"==typeof e&&"type"in e&&it(e)}function lt(e,t){let n=0;return{measureTime(e){const t=Date.now();try{return e()}finally{const e=Date.now();n+=e-t}},warnIfExceeded(){}}}var ut=class e extends Array{constructor(...t){super(...t),Object.setPrototypeOf(this,e.prototype)}static get[Symbol.species](){return e}concat(...e){return super.concat.apply(this,e)}prepend(...t){return 1===t.length&&Array.isArray(t[0])?new e(...t[0].concat(this)):new e(...t.concat(this))}};function dt(e){return ce(e)?Be(e,()=>{}):e}function pt(e,t,n){return e.has(t)?e.get(t):e.set(t,n(t)).get(t)}function ht(e){return"object"!=typeof e||null==e||Object.isFrozen(e)}function ft(e,t,n){const r=gt(e,t,n);return{detectMutations:()=>mt(e,t,r,n)}}function gt(e,t=[],n,r="",o=new Set){const s={value:n};if(!e(n)&&!o.has(n)){o.add(n),s.children={};for(const o in n){const i=r?r+"."+o:o;t.length&&-1!==t.indexOf(i)||(s.children[o]=gt(e,t,n[o],i))}}return s}function mt(e,t=[],n,r,o=!1,s=""){const i=n?n.value:void 0,a=i===r;if(o&&!a&&!Number.isNaN(r))return{wasMutated:!0,path:s};if(e(i)||e(r))return{wasMutated:!1};const c={};for(let u in n.children)c[u]=!0;for(let u in r)c[u]=!0;const l=t.length>0;for(let u in c){const o=s?s+"."+u:u;if(l&&t.some(e=>e instanceof RegExp?e.test(o):o===e))continue;const i=mt(e,t,n.children[u],r[u],a,o);if(i.wasMutated)return i}return{wasMutated:!1}}function yt(e){const t=typeof e;return null==e||"string"===t||"boolean"===t||"number"===t||Array.isArray(e)||Y(e)}function vt(e,t="",n=yt,r,o=[],s){let i;if(!n(e))return{keyPath:t||"<root>",value:e};if("object"!=typeof e||null===e)return!1;if(null==s?void 0:s.has(e))return!1;const a=null!=r?r(e):Object.entries(e),c=o.length>0;for(const[l,u]of a){const e=t?t+"."+l:l;if(!c||!o.some(t=>t instanceof RegExp?t.test(e):e===t)){if(!n(u))return{keyPath:e,value:u};if("object"==typeof u&&(i=vt(u,e,n,r,o,s),i))return i}}return s&&bt(e)&&s.add(e),!1}function bt(e){if(!Object.isFrozen(e))return!1;for(const t of Object.values(e))if("object"==typeof t&&null!==t&&!bt(t))return!1;return!0}function wt(e){return"boolean"==typeof e}var xt=()=>function(e){const{thunk:t=!0,immutableCheck:n=!0,serializableCheck:r=!0,actionCreatorCheck:o=!0}=null!=e?e:{};let s=new ut;if(t&&(wt(t)?s.push(rt):s.push(ot(t.extraArgument))),"production"!==process.env.NODE_ENV){if(n){let e={};wt(n)||(e=n),s.unshift(function(e={}){if("production"===process.env.NODE_ENV)return()=>e=>t=>e(t);{let t=function(e,t,r,o){return JSON.stringify(e,n(t,o),r)},n=function(e,t){let n=[],r=[];return t||(t=function(e,t){return n[0]===t?"[Circular ~]":"[Circular ~."+r.slice(0,n.indexOf(t)).join(".")+"]"}),function(o,s){if(n.length>0){var i=n.indexOf(this);~i?n.splice(i+1):n.push(this),~i?r.splice(i,1/0,o):r.push(o),~n.indexOf(s)&&(s=t.call(this,o,s))}else n.push(s);return null==e?s:e.call(this,o,s)}},{isImmutable:r=ht,ignoredPaths:o,warnAfter:s=32}=e;const i=ft.bind(null,r,o);return({getState:e})=>{let n,r=e(),o=i(r);return s=>a=>{const c=lt();c.measureTime(()=>{if(r=e(),n=o.detectMutations(),o=i(r),n.wasMutated)throw new Error("production"===process.env.NODE_ENV?zt(19):`A state mutation was detected between dispatches, in the path '${n.path||""}'.  This may cause incorrect behavior. (https://redux.js.org/style-guide/style-guide#do-not-mutate-state)`)});const l=s(a);return c.measureTime(()=>{if(r=e(),n=o.detectMutations(),o=i(r),n.wasMutated)throw new Error("production"===process.env.NODE_ENV?zt(20):`A state mutation was detected inside a dispatch, in the path: ${n.path||""}. Take a look at the reducer(s) handling the action ${t(a)}. (https://redux.js.org/style-guide/style-guide#do-not-mutate-state)`)}),c.warnIfExceeded(),l}}}}(e))}if(r){let e={};wt(r)||(e=r),s.push(function(e={}){if("production"===process.env.NODE_ENV)return()=>e=>t=>e(t);{const{isSerializable:t=yt,getEntries:n,ignoredActions:r=[],ignoredActionPaths:o=["meta.arg","meta.baseQueryMeta"],ignoredPaths:s=[],warnAfter:i=32,ignoreState:a=!1,ignoreActions:c=!1,disableCache:l=!1}=e,u=!l&&WeakSet?new WeakSet:void 0;return e=>i=>l=>{if(!ee(l))return i(l);const d=i(l),p=lt();return c||r.length&&-1!==r.indexOf(l.type)||p.measureTime(()=>{const e=vt(l,"",t,n,o,u);if(e){const{keyPath:t,value:n}=e}}),a||(p.measureTime(()=>{const r=vt(e.getState(),"",t,n,s,u);if(r){const{keyPath:e,value:t}=r}}),p.warnIfExceeded()),d}}}(e))}if(o){let e={};wt(o)||(e=o),s.unshift(function(e={}){if("production"===process.env.NODE_ENV)return()=>e=>t=>e(t);const{isActionCreator:t=ct}=e;return()=>e=>n=>(t(n),e(n))}(e))}}return s},St=e=>t=>{setTimeout(t,e)};function Nt(e){const t={},n=[];let r;const o={addCase(e,s){if("production"!==process.env.NODE_ENV){if(n.length>0)throw new Error("production"===process.env.NODE_ENV?zt(26):"`builder.addCase` should only be called before calling `builder.addMatcher`");if(r)throw new Error("production"===process.env.NODE_ENV?zt(27):"`builder.addCase` should only be called before calling `builder.addDefaultCase`")}const i="string"==typeof e?e:e.type;if(!i)throw new Error("production"===process.env.NODE_ENV?zt(28):"`builder.addCase` cannot be called with an empty action type");if(i in t)throw new Error("production"===process.env.NODE_ENV?zt(29):`\`builder.addCase\` cannot be called with two reducers for the same action type '${i}'`);return t[i]=s,o},addMatcher(e,t){if("production"!==process.env.NODE_ENV&&r)throw new Error("production"===process.env.NODE_ENV?zt(30):"`builder.addMatcher` should only be called before calling `builder.addDefaultCase`");return n.push({matcher:e,reducer:t}),o},addDefaultCase(e){if("production"!==process.env.NODE_ENV&&r)throw new Error("production"===process.env.NODE_ENV?zt(31):"`builder.addDefaultCase` can only be called once");return r=e,o}};return e(o),[t,n,r]}function Et(...e){return t=>e.some(e=>((e,t)=>it(e)?e.match(t):e(t))(e,t))}var Ot=["name","message","stack","code"],kt=class{constructor(e,t){p(this,"_type"),this.payload=e,this.meta=t}},jt=class{constructor(e,t){p(this,"_type"),this.payload=e,this.meta=t}},Ct=e=>{if("object"==typeof e&&null!==e){const t={};for(const n of Ot)"string"==typeof e[n]&&(t[n]=e[n]);return t}return{message:String(e)}},_t="External signal was aborted",Mt=(()=>{function e(e,t,n){const r=at(e+"/fulfilled",(e,t,n,r)=>({payload:e,meta:u(l({},r||{}),{arg:n,requestId:t,requestStatus:"fulfilled"})})),o=at(e+"/pending",(e,t,n)=>({payload:void 0,meta:u(l({},n||{}),{arg:t,requestId:e,requestStatus:"pending"})})),s=at(e+"/rejected",(e,t,r,o,s)=>({payload:o,error:(n&&n.serializeError||Ct)(e||"Rejected"),meta:u(l({},s||{}),{arg:r,requestId:t,rejectedWithValue:!!o,requestStatus:"rejected",aborted:"AbortError"===(null==e?void 0:e.name),condition:"ConditionError"===(null==e?void 0:e.name)})}));return Object.assign(function(e,{signal:i}={}){return(a,c,l)=>{const u=(null==n?void 0:n.idGenerator)?n.idGenerator(e):((e=21)=>{let t="",n=e;for(;n--;)t+="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW"[64*Math.random()|0];return t})(),d=new AbortController;let p,f;function g(e){f=e,d.abort()}i&&(i.aborted?g(_t):i.addEventListener("abort",()=>g(_t),{once:!0}));const m=function(){return h(this,null,function*(){var i,h;let m;try{let s=null==(i=null==n?void 0:n.condition)?void 0:i.call(n,e,{getState:c,extra:l});if(null!==(y=s)&&"object"==typeof y&&"function"==typeof y.then&&(s=yield s),!1===s||d.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const v=new Promise((e,t)=>{p=()=>{t({name:"AbortError",message:f||"Aborted"})},d.signal.addEventListener("abort",p)});a(o(u,e,null==(h=null==n?void 0:n.getPendingMeta)?void 0:h.call(n,{requestId:u,arg:e},{getState:c,extra:l}))),m=yield Promise.race([v,Promise.resolve(t(e,{dispatch:a,getState:c,extra:l,requestId:u,signal:d.signal,abort:g,rejectWithValue:(e,t)=>new kt(e,t),fulfillWithValue:(e,t)=>new jt(e,t)})).then(t=>{if(t instanceof kt)throw t;return t instanceof jt?r(t.payload,u,e,t.meta):r(t,u,e)})])}catch(v){m=v instanceof kt?s(null,u,e,v.payload,v.meta):s(v,u,e)}finally{p&&d.signal.removeEventListener("abort",p)}var y;return n&&!n.dispatchConditionRejection&&s.match(m)&&m.meta.condition||a(m),m})}();return Object.assign(m,{abort:g,requestId:u,arg:e,unwrap:()=>m.then(Rt)})}},{pending:o,rejected:s,fulfilled:r,settled:Et(s,r),typePrefix:e})}return e.withTypes=()=>e,e})();function Rt(e){if(e.meta&&e.meta.rejectedWithValue)throw e.payload;if(e.error)throw e.error;return e.payload}var Tt=Symbol.for("rtk-slice-createasyncthunk");function Pt(e,t){return`${e}/${t}`}function Dt({creators:e}={}){var t;const n=null==(t=null==e?void 0:e.asyncThunk)?void 0:t[Tt];return function(e){const{name:t,reducerPath:r=t}=e;if(!t)throw new Error("production"===process.env.NODE_ENV?zt(11):"`name` is a required option for createSlice");"undefined"!=typeof process&&"development"===process.env.NODE_ENV&&e.initialState;const o=("function"==typeof e.reducers?e.reducers(function(){function e(e,t){return l({_reducerDefinitionType:"asyncThunk",payloadCreator:e},t)}return e.withTypes=()=>e,{reducer:e=>Object.assign({[e.name]:(...t)=>e(...t)}[e.name],{_reducerDefinitionType:"reducer"}),preparedReducer:(e,t)=>({_reducerDefinitionType:"reducerWithPrepare",prepare:e,reducer:t}),asyncThunk:e}}()):e.reducers)||{},s=Object.keys(o),i={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},a={addCase(e,t){const n="string"==typeof e?e:e.type;if(!n)throw new Error("production"===process.env.NODE_ENV?zt(12):"`context.addCase` cannot be called with an empty action type");if(n in i.sliceCaseReducersByType)throw new Error("production"===process.env.NODE_ENV?zt(13):"`context.addCase` cannot be called with two reducers for the same action type: "+n);return i.sliceCaseReducersByType[n]=t,a},addMatcher:(e,t)=>(i.sliceMatchers.push({matcher:e,reducer:t}),a),exposeAction:(e,t)=>(i.actionCreators[e]=t,a),exposeCaseReducer:(e,t)=>(i.sliceCaseReducersByName[e]=t,a)};function c(){if("production"!==process.env.NODE_ENV&&"object"==typeof e.extraReducers)throw new Error("production"===process.env.NODE_ENV?zt(14):"The object notation for `createSlice.extraReducers` has been removed. Please use the 'builder callback' notation instead: https://redux-toolkit.js.org/api/createSlice");const[t={},n=[],r]="function"==typeof e.extraReducers?Nt(e.extraReducers):[e.extraReducers],o=l(l({},t),i.sliceCaseReducersByType);return function(e,t){process.env.NODE_ENV;let n,[r,o,s]=Nt(t);if("function"==typeof e)n=()=>dt(e());else{const t=dt(e);n=()=>t}function i(e=n(),t){let i=[r[t.type],...o.filter(({matcher:e})=>e(t)).map(({reducer:e})=>e)];return 0===i.filter(e=>!!e).length&&(i=[s]),i.reduce((e,n)=>{if(n){if(ae(e)){const r=n(e,t);return void 0===r?e:r}if(ce(e))return Be(e,e=>n(e,t));{const r=n(e,t);if(void 0===r){if(null===e)return e;throw Error("A case reducer on a non-draftable value must not return undefined")}return r}}return e},e)}return i.getInitialState=n,i}(e.initialState,e=>{for(let t in o)e.addCase(t,o[t]);for(let t of i.sliceMatchers)e.addMatcher(t.matcher,t.reducer);for(let t of n)e.addMatcher(t.matcher,t.reducer);r&&e.addDefaultCase(r)})}s.forEach(r=>{const s=o[r],i={reducerName:r,type:Pt(t,r),createNotation:"function"==typeof e.reducers};!function(e){return"asyncThunk"===e._reducerDefinitionType}(s)?function({type:e,reducerName:t,createNotation:n},r,o){let s,i;if("reducer"in r){if(n&&!function(e){return"reducerWithPrepare"===e._reducerDefinitionType}(r))throw new Error("production"===process.env.NODE_ENV?zt(17):"Please use the `create.preparedReducer` notation for prepared action creators with the `create` notation.");s=r.reducer,i=r.prepare}else s=r;o.addCase(e,s).exposeCaseReducer(t,s).exposeAction(t,i?at(e,i):at(e))}(i,s,a):function({type:e,reducerName:t},n,r,o){if(!o)throw new Error("production"===process.env.NODE_ENV?zt(18):"Cannot use `create.asyncThunk` in the built-in `createSlice`. Use `buildCreateSlice({ creators: { asyncThunk: asyncThunkCreator } })` to create a customised version of `createSlice`.");const{payloadCreator:s,fulfilled:i,pending:a,rejected:c,settled:l,options:u}=n,d=o(e,s,u);r.exposeAction(t,d),i&&r.addCase(d.fulfilled,i),a&&r.addCase(d.pending,a),c&&r.addCase(d.rejected,c),l&&r.addMatcher(d.settled,l),r.exposeCaseReducer(t,{fulfilled:i||$t,pending:a||$t,rejected:c||$t,settled:l||$t})}(i,s,a,n)});const p=e=>e,h=new Map,f=new WeakMap;let g;function m(e,t){return g||(g=c()),g(e,t)}function y(){return g||(g=c()),g.getInitialState()}function v(t,n=!1){function r(e){let o=e[t];if(void 0===o)if(n)o=pt(f,r,y);else if("production"!==process.env.NODE_ENV)throw new Error("production"===process.env.NODE_ENV?zt(15):"selectSlice returned undefined for an uninjected slice reducer");return o}function o(t=p){const r=pt(h,n,()=>new WeakMap);return pt(r,t,()=>{var r;const o={};for(const[s,i]of Object.entries(null!=(r=e.selectors)?r:{}))o[s]=Lt(i,t,()=>pt(f,t,y),n);return o})}return{reducerPath:t,getSelectors:o,get selectors(){return o(r)},selectSlice:r}}const b=u(l({name:t,reducer:m,actions:i.actionCreators,caseReducers:i.sliceCaseReducersByName,getInitialState:y},v(r)),{injectInto(e,t={}){var n=t,{reducerPath:o}=n,s=d(n,["reducerPath"]);const i=null!=o?o:r;return e.inject({reducerPath:i,reducer:m},s),l(l({},b),v(i,!0))}});return b}}function Lt(e,t,n,r){function o(o,...s){let i=t(o);if(void 0===i)if(r)i=n();else if("production"!==process.env.NODE_ENV)throw new Error("production"===process.env.NODE_ENV?zt(16):"selectState returned undefined for an uninjected slice reducer");return e(i,...s)}return o.unwrapped=e,o}var It=Dt();function $t(){}function zt(e){return`Minified Redux Toolkit error #${e}; visit https://redux-toolkit.js.org/Errors?code=${e} for the full message or use the non-minified dev environment for full errors. `}const At=Mt("chat/sendMessage",e=>h(null,null,function*(){return(yield fetch("/api/chat/messages",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json()})),Ft=Mt("chat/startConversation",e=>h(null,null,function*(){return(yield fetch("/api/chat/conversations",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({tenantId:e})})).json()})),Vt=Mt("chat/requestHumanAgent",e=>h(null,null,function*(){return(yield fetch(`/api/chat/conversations/${e}/escalate`,{method:"POST"})).json()})),Ut=It({name:"chat",initialState:{isOpen:!1,isMinimized:!1,currentConversation:null,isConnected:!1,isTyping:!1,unreadCount:0,isLoading:!1,error:null,connectionStatus:"disconnected"},reducers:{toggleChat:e=>{e.isOpen=!e.isOpen,e.isOpen&&(e.unreadCount=0,e.isMinimized=!1)},minimizeChat:e=>{e.isMinimized=!0},maximizeChat:e=>{e.isMinimized=!1},closeChat:e=>{e.isOpen=!1,e.isMinimized=!1},addMessage:(e,t)=>{e.currentConversation&&(e.currentConversation.messages.push(t.payload),e.isOpen||"user"===t.payload.sender||(e.unreadCount+=1))},setTyping:(e,t)=>{e.isTyping=t.payload.isTyping,e.typingUser=t.payload.user},setConnectionStatus:(e,t)=>{e.connectionStatus=t.payload,e.isConnected="connected"===t.payload},updateConversationStatus:(e,t)=>{e.currentConversation&&(e.currentConversation.status=t.payload)},assignAgent:(e,t)=>{e.currentConversation&&(e.currentConversation.assignedAgent=t.payload)},clearError:e=>{e.error=null},markAsRead:e=>{e.unreadCount=0,e.lastSeen=new Date}},extraReducers:e=>{e.addCase(At.pending,e=>{e.isLoading=!0,e.error=null}).addCase(At.fulfilled,(e,t)=>{e.isLoading=!1,t.payload.success}).addCase(At.rejected,(e,t)=>{e.isLoading=!1,e.error=t.error.message||"Failed to send message"}).addCase(Ft.pending,e=>{e.isLoading=!0,e.error=null}).addCase(Ft.fulfilled,(e,t)=>{e.isLoading=!1,e.currentConversation=t.payload}).addCase(Ft.rejected,(e,t)=>{e.isLoading=!1,e.error=t.error.message||"Failed to start conversation"}).addCase(Vt.pending,e=>{e.isLoading=!0}).addCase(Vt.fulfilled,e=>{e.isLoading=!1,e.currentConversation&&(e.currentConversation.status="waiting")}).addCase(Vt.rejected,(e,t)=>{e.isLoading=!1,e.error=t.error.message||"Failed to request human agent"})}}),{toggleChat:Wt,minimizeChat:Bt,maximizeChat:qt,closeChat:Ht,addMessage:Kt,setTyping:Jt,setConnectionStatus:Yt,updateConversationStatus:Xt,assignAgent:Gt,clearError:Qt,markAsRead:Zt}=Ut.actions,en=Ut.reducer,tn={primaryColor:"#3b82f6",secondaryColor:"#64748b",backgroundColor:"#ffffff",textColor:"#1f2937",borderRadius:"12px",fontFamily:"Inter, system-ui, sans-serif",fontSize:"14px",headerColor:"#3b82f6",headerTextColor:"#ffffff",userMessageColor:"#3b82f6",botMessageColor:"#f1f5f9",shadowColor:"rgba(0, 0, 0, 0.1)",position:"bottom-right",size:"medium",animation:"slide"},nn=It({name:"theme",initialState:{config:tn,isRTL:!1,language:"en",branding:{welcomeMessage:"Hello! How can I help you today?",placeholderText:"Type your message..."}},reducers:{updateThemeConfig:(e,t)=>{e.config=l(l({},e.config),t.payload)},setLanguage:(e,t)=>{e.language=t.payload,e.isRTL="ar"===t.payload},setBranding:(e,t)=>{e.branding=l(l({},e.branding),t.payload)},setCustomCSS:(e,t)=>{e.customCSS=t.payload},resetTheme:e=>{e.config=tn,e.customCSS=void 0},applyTenantTheme:(e,t)=>{const{theme:n,branding:r,language:o,customCSS:s}=t.payload;e.config=l(l({},e.config),n),e.branding=l(l({},e.branding),r),o&&(e.language=o,e.isRTL="ar"===o),s&&(e.customCSS=s)}}}),{updateThemeConfig:rn,setLanguage:on,setBranding:sn,setCustomCSS:an,resetTheme:cn,applyTenantTheme:ln}=nn.actions,un=nn.reducer,dn=It({name:"config",initialState:{widget:{tenantId:"",apiUrl:"/api",websocketUrl:"/ws",features:{fileUpload:!0,voiceMessages:!1,typing:!0,readReceipts:!0,agentHandoff:!0,conversationRating:!0,conversationTranscript:!0,proactiveMessages:!1},behavior:{autoOpen:!1,autoOpenDelay:3e3,showWelcomeMessage:!0,persistConversation:!0,maxFileSize:10485760,allowedFileTypes:["image/*",".pdf",".doc",".docx",".txt"],maxMessageLength:1e3},security:{allowedDomains:[],requireAuth:!1,encryptMessages:!1},analytics:{trackEvents:!0,trackUserJourney:!1,customEvents:[]}},isInitialized:!1,isEmbedded:!1,parentDomain:"",sessionId:"",metadata:{}},reducers:{initializeWidget:(e,t)=>{const{tenantId:n,config:r,userId:o,metadata:s}=t.payload;e.widget.tenantId=n,r&&(r.apiUrl&&(e.widget.apiUrl=r.apiUrl),r.websocketUrl&&(e.widget.websocketUrl=r.websocketUrl),r.features&&(e.widget.features=l(l({},e.widget.features),r.features)),r.behavior&&(e.widget.behavior=l(l({},e.widget.behavior),r.behavior))),e.userId=o,e.metadata=s||{},e.sessionId=`session_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,e.isInitialized=!0,e.parentDomain=window.location.hostname,e.isEmbedded=window!==window.top},updateConfig:(e,t)=>{e.widget=l(l({},e.widget),t.payload)},setUserId:(e,t)=>{e.userId=t.payload},updateMetadata:(e,t)=>{e.metadata=l(l({},e.metadata),t.payload)},setFeatureEnabled:(e,t)=>{e.widget.features[t.payload.feature]=t.payload.enabled},updateBehavior:(e,t)=>{e.widget.behavior=l(l({},e.widget.behavior),t.payload)},trackEvent:(e,t)=>{if(e.widget.analytics.trackEvents){const n=u(l({},t.payload),{timestamp:(new Date).toISOString(),sessionId:e.sessionId,tenantId:e.widget.tenantId,userId:e.userId});"undefined"!=typeof window&&window.gtag&&window.gtag("event",t.payload.event,n)}}}}),{initializeWidget:pn,updateConfig:hn,setUserId:fn,updateMetadata:gn,setFeatureEnabled:mn,updateBehavior:yn,trackEvent:vn}=dn.actions,bn=function(e){const t=xt(),{reducer:n,middleware:r,devTools:o=!0,duplicateMiddlewareCheck:s=!0,preloadedState:i,enhancers:a}=e||{};let c,d;if("function"==typeof n)c=n;else{if(!Y(n))throw new Error("production"===process.env.NODE_ENV?zt(1):"`reducer` is a required argument, and must be a function or an object of functions that can be passed to combineReducers");c=function(e){const t=Object.keys(e),n={};for(let a=0;a<t.length;a++){const r=t[a];"production"!==process.env.NODE_ENV&&void 0===e[r]&&Q(`No reducer provided for key "${r}"`),"function"==typeof e[r]&&(n[r]=e[r])}const r=Object.keys(n);let o,s;"production"!==process.env.NODE_ENV&&(o={});try{!function(e){Object.keys(e).forEach(t=>{const n=e[t];if(void 0===n(void 0,{type:J.INIT}))throw new Error("production"===process.env.NODE_ENV?q(12):`The slice reducer for key "${t}" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.`);if(void 0===n(void 0,{type:J.PROBE_UNKNOWN_ACTION()}))throw new Error("production"===process.env.NODE_ENV?q(13):`The slice reducer for key "${t}" returned undefined when probed with a random type. Don't try to handle '${J.INIT}' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.`)})}(n)}catch(i){s=i}return function(e={},t){if(s)throw s;if("production"!==process.env.NODE_ENV){const r=function(e,t,n,r){const o=Object.keys(t),s=n&&n.type===J.INIT?"preloadedState argument passed to createStore":"previous state received by the reducer";if(0===o.length)return"Store does not have a valid reducer. Make sure the argument passed to combineReducers is an object whose values are reducers.";if(!Y(e))return`The ${s} has unexpected type of "${X(e)}". Expected argument to be an object with the following keys: "${o.join('", "')}"`;const i=Object.keys(e).filter(e=>!t.hasOwnProperty(e)&&!r[e]);return i.forEach(e=>{r[e]=!0}),n&&n.type===J.REPLACE?void 0:i.length>0?`Unexpected ${i.length>1?"keys":"key"} "${i.join('", "')}" found in ${s}. Expected to find one of the known reducer keys instead: "${o.join('", "')}". Unexpected keys will be ignored.`:void 0}(e,n,t,o);r&&Q(r)}let i=!1;const a={};for(let o=0;o<r.length;o++){const s=r[o],c=n[s],l=e[s],u=c(l,t);if(void 0===u){const e=t&&t.type;throw new Error("production"===process.env.NODE_ENV?q(14):`When called with an action of type ${e?`"${String(e)}"`:"(unknown type)"}, the slice reducer for key "${s}" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.`)}a[s]=u,i=i||u!==l}return i=i||r.length!==Object.keys(e).length,i?a:e}}(n)}if("production"!==process.env.NODE_ENV&&r&&"function"!=typeof r)throw new Error("production"===process.env.NODE_ENV?zt(2):"`middleware` field must be a callback");if("function"==typeof r){if(d=r(t),"production"!==process.env.NODE_ENV&&!Array.isArray(d))throw new Error("production"===process.env.NODE_ENV?zt(3):"when using a middleware builder function, an array of middleware must be returned")}else d=t();if("production"!==process.env.NODE_ENV&&d.some(e=>"function"!=typeof e))throw new Error("production"===process.env.NODE_ENV?zt(4):"each middleware provided to configureStore must be a function");if("production"!==process.env.NODE_ENV&&s){let e=new Set;d.forEach(t=>{if(e.has(t))throw new Error("production"===process.env.NODE_ENV?zt(42):"Duplicate middleware references found when creating the store. Ensure that each middleware is only included once.");e.add(t)})}let p=Z;o&&(p=st(l({trace:"production"!==process.env.NODE_ENV},"object"==typeof o&&o)));const h=function(...e){return t=>(n,r)=>{const o=t(n,r);let s=()=>{throw new Error("production"===process.env.NODE_ENV?q(15):"Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")};const i={getState:o.getState,dispatch:(e,...t)=>s(e,...t)},a=e.map(e=>e(i));return s=Z(...a)(o.dispatch),u(l({},o),{dispatch:s})}}(...d),f=(e=>function(t){const{autoBatch:n=!0}=null!=t?t:{};let r=new ut(e);return n&&r.push(((e={type:"raf"})=>t=>(...n)=>{const r=t(...n);let o=!0,s=!1,i=!1;const a=new Set,c="tick"===e.type?queueMicrotask:"raf"===e.type?"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame:St(10):"callback"===e.type?e.queueNotification:St(e.timeout),l=()=>{i=!1,s&&(s=!1,a.forEach(e=>e()))};return Object.assign({},r,{subscribe(e){const t=r.subscribe(()=>o&&e());return a.add(e),()=>{t(),a.delete(e)}},dispatch(e){var t;try{return o=!(null==(t=null==e?void 0:e.meta)?void 0:t.RTK_autoBatch),s=!o,s&&(i||(i=!0,c(l))),r.dispatch(e)}finally{o=!0}}})})("object"==typeof n?n:void 0)),r})(h);if("production"!==process.env.NODE_ENV&&a&&"function"!=typeof a)throw new Error("production"===process.env.NODE_ENV?zt(5):"`enhancers` field must be a callback");let g="function"==typeof a?a(f):f();if("production"!==process.env.NODE_ENV&&!Array.isArray(g))throw new Error("production"===process.env.NODE_ENV?zt(6):"`enhancers` callback must return an array");if("production"!==process.env.NODE_ENV&&g.some(e=>"function"!=typeof e))throw new Error("production"===process.env.NODE_ENV?zt(7):"each enhancer provided to configureStore must be a function");return"production"!==process.env.NODE_ENV&&d.length&&g.includes(h),G(c,i,p(...g))}({reducer:{chat:en,theme:un,config:dn.reducer},middleware:e=>e({serializableCheck:{ignoredActions:["persist/PERSIST"]}})});var wn,xn,Sn,Nn={exports:{}},En={},On={};var kn=(Sn||(Sn=1,"production"===process.env.NODE_ENV?Nn.exports=function(){if(wn)return En;wn=1;var t=e,n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,s=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i={key:!0,ref:!0,__self:!0,__source:!0};function a(e,t,r){var a,c={},l=null,u=null;for(a in void 0!==r&&(l=""+r),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(u=t.ref),t)o.call(t,a)&&!i.hasOwnProperty(a)&&(c[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===c[a]&&(c[a]=t[a]);return{$$typeof:n,type:e,key:l,ref:u,props:c,_owner:s.current}}return En.Fragment=r,En.jsx=a,En.jsxs=a,En}():Nn.exports=(xn||(xn=1,"production"!==process.env.NODE_ENV&&function(){var t,n=e,r=Symbol.for("react.element"),o=Symbol.for("react.portal"),s=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),a=Symbol.for("react.profiler"),c=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),p=Symbol.for("react.suspense_list"),h=Symbol.for("react.memo"),f=Symbol.for("react.lazy"),g=Symbol.for("react.offscreen"),m=Symbol.iterator,y=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function v(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];!function(e,t,n){var r=y.ReactDebugCurrentFrame.getStackAddendum();""!==r&&(t+="%s",n=n.concat([r]));var o=n.map(function(e){return String(e)});o.unshift("Warning: "+t),Function.prototype.apply.call(console.error,console,o)}(0,e,n)}function b(e){return e.displayName||"Context"}function w(e){if(null==e)return null;if("number"==typeof e.tag&&v("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),"function"==typeof e)return e.displayName||e.name||null;if("string"==typeof e)return e;switch(e){case s:return"Fragment";case o:return"Portal";case a:return"Profiler";case i:return"StrictMode";case d:return"Suspense";case p:return"SuspenseList"}if("object"==typeof e)switch(e.$$typeof){case l:return b(e)+".Consumer";case c:return b(e._context)+".Provider";case u:return function(e,t,n){var r=e.displayName;if(r)return r;var o=t.displayName||t.name||"";return""!==o?n+"("+o+")":n}(e,e.render,"ForwardRef");case h:var t=e.displayName||null;return null!==t?t:w(e.type)||"Memo";case f:var n=e,r=n._payload,g=n._init;try{return w(g(r))}catch(m){return null}}return null}t=Symbol.for("react.module.reference");var x,S,N,E,O,k,j,C=Object.assign,_=0;function M(){}M.__reactDisabledLog=!0;var R,T=y.ReactCurrentDispatcher;function P(e,t,n){if(void 0===R)try{throw Error()}catch(o){var r=o.stack.trim().match(/\n( *(at )?)/);R=r&&r[1]||""}return"\n"+R+e}var D,L=!1,I="function"==typeof WeakMap?WeakMap:Map;function $(e,t){if(!e||L)return"";var n,r=D.get(e);if(void 0!==r)return r;L=!0;var o,s=Error.prepareStackTrace;Error.prepareStackTrace=void 0,o=T.current,T.current=null,function(){if(0===_){x=console.log,S=console.info,N=console.warn,E=console.error,O=console.group,k=console.groupCollapsed,j=console.groupEnd;var e={configurable:!0,enumerable:!0,value:M,writable:!0};Object.defineProperties(console,{info:e,log:e,warn:e,error:e,group:e,groupCollapsed:e,groupEnd:e})}_++}();try{if(t){var i=function(){throw Error()};if(Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),"object"==typeof Reflect&&Reflect.construct){try{Reflect.construct(i,[])}catch(f){n=f}Reflect.construct(e,[],i)}else{try{i.call()}catch(f){n=f}e.call(i.prototype)}}else{try{throw Error()}catch(f){n=f}e()}}catch(g){if(g&&n&&"string"==typeof g.stack){for(var a=g.stack.split("\n"),c=n.stack.split("\n"),l=a.length-1,u=c.length-1;l>=1&&u>=0&&a[l]!==c[u];)u--;for(;l>=1&&u>=0;l--,u--)if(a[l]!==c[u]){if(1!==l||1!==u)do{if(l--,--u<0||a[l]!==c[u]){var d="\n"+a[l].replace(" at new "," at ");return e.displayName&&d.includes("<anonymous>")&&(d=d.replace("<anonymous>",e.displayName)),"function"==typeof e&&D.set(e,d),d}}while(l>=1&&u>=0);break}}}finally{L=!1,T.current=o,function(){if(0===--_){var e={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:C({},e,{value:x}),info:C({},e,{value:S}),warn:C({},e,{value:N}),error:C({},e,{value:E}),group:C({},e,{value:O}),groupCollapsed:C({},e,{value:k}),groupEnd:C({},e,{value:j})})}_<0&&v("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}(),Error.prepareStackTrace=s}var p=e?e.displayName||e.name:"",h=p?P(p):"";return"function"==typeof e&&D.set(e,h),h}function z(e,t,n){if(null==e)return"";if("function"==typeof e)return $(e,!(!(r=e.prototype)||!r.isReactComponent));var r;if("string"==typeof e)return P(e);switch(e){case d:return P("Suspense");case p:return P("SuspenseList")}if("object"==typeof e)switch(e.$$typeof){case u:return $(e.render,!1);case h:return z(e.type,t,n);case f:var o=e,s=o._payload,i=o._init;try{return z(i(s),t,n)}catch(a){}}return""}D=new I;var A=Object.prototype.hasOwnProperty,F={},V=y.ReactDebugCurrentFrame;function U(e){if(e){var t=e._owner,n=z(e.type,e._source,t?t.type:null);V.setExtraStackFrame(n)}else V.setExtraStackFrame(null)}var W=Array.isArray;function B(e){return W(e)}function q(e){return""+e}function H(e){if(function(e){try{return q(e),!1}catch(t){return!0}}(e))return v("The provided key is an unsupported type %s. This value must be coerced to a string before before using it here.",function(e){return"function"==typeof Symbol&&Symbol.toStringTag&&e[Symbol.toStringTag]||e.constructor.name||"Object"}(e)),q(e)}var K,J,Y,X=y.ReactCurrentOwner,G={key:!0,ref:!0,__self:!0,__source:!0},Q=y.ReactCurrentOwner,Z=y.ReactDebugCurrentFrame;function ee(e){if(e){var t=e._owner,n=z(e.type,e._source,t?t.type:null);Z.setExtraStackFrame(n)}else Z.setExtraStackFrame(null)}function te(e){return"object"==typeof e&&null!==e&&e.$$typeof===r}function ne(){if(Q.current){var e=w(Q.current.type);if(e)return"\n\nCheck the render method of `"+e+"`."}return""}Y=!1;var re={};function oe(e,t){if(e._store&&!e._store.validated&&null==e.key){e._store.validated=!0;var n=function(e){var t=ne();if(!t){var n="string"==typeof e?e:e.displayName||e.name;n&&(t="\n\nCheck the top-level render call using <"+n+">.")}return t}(t);if(!re[n]){re[n]=!0;var r="";e&&e._owner&&e._owner!==Q.current&&(r=" It was passed a child from "+w(e._owner.type)+"."),ee(e),v('Each child in a list should have a unique "key" prop.%s%s See https://reactjs.org/link/warning-keys for more information.',n,r),ee(null)}}}function se(e,t){if("object"==typeof e)if(B(e))for(var n=0;n<e.length;n++){var r=e[n];te(r)&&oe(r,t)}else if(te(e))e._store&&(e._store.validated=!0);else if(e){var o=function(e){if(null===e||"object"!=typeof e)return null;var t=m&&e[m]||e["@@iterator"];return"function"==typeof t?t:null}(e);if("function"==typeof o&&o!==e.entries)for(var s,i=o.call(e);!(s=i.next()).done;)te(s.value)&&oe(s.value,t)}}var ie={};function ae(e,n,o,m,y,b){var x=function(e){return"string"==typeof e||"function"==typeof e||e===s||e===a||e===i||e===d||e===p||e===g||"object"==typeof e&&null!==e&&(e.$$typeof===f||e.$$typeof===h||e.$$typeof===c||e.$$typeof===l||e.$$typeof===u||e.$$typeof===t||void 0!==e.getModuleId)}(e);if(!x){var S,N="";(void 0===e||"object"==typeof e&&null!==e&&0===Object.keys(e).length)&&(N+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),N+=ne(),null===e?S="null":B(e)?S="array":void 0!==e&&e.$$typeof===r?(S="<"+(w(e.type)||"Unknown")+" />",N=" Did you accidentally export a JSX literal instead of a component?"):S=typeof e,v("React.jsx: type is invalid -- expected a string (for built-in components) or a class/function (for composite components) but got: %s.%s",S,N)}var E=function(e,t,n,o,s){var i,a={},c=null,l=null;for(i in void 0!==n&&(H(n),c=""+n),function(e){if(A.call(e,"key")){var t=Object.getOwnPropertyDescriptor(e,"key").get;if(t&&t.isReactWarning)return!1}return void 0!==e.key}(t)&&(H(t.key),c=""+t.key),function(e){if(A.call(e,"ref")){var t=Object.getOwnPropertyDescriptor(e,"ref").get;if(t&&t.isReactWarning)return!1}return void 0!==e.ref}(t)&&(l=t.ref,function(e){"string"==typeof e.ref&&X.current}(t)),t)A.call(t,i)&&!G.hasOwnProperty(i)&&(a[i]=t[i]);if(e&&e.defaultProps){var u=e.defaultProps;for(i in u)void 0===a[i]&&(a[i]=u[i])}if(c||l){var d="function"==typeof e?e.displayName||e.name||"Unknown":e;c&&function(e,t){var n=function(){K||(K=!0,v("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",t))};n.isReactWarning=!0,Object.defineProperty(e,"key",{get:n,configurable:!0})}(a,d),l&&function(e,t){var n=function(){J||(J=!0,v("%s: `ref` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://reactjs.org/link/special-props)",t))};n.isReactWarning=!0,Object.defineProperty(e,"ref",{get:n,configurable:!0})}(a,d)}return function(e,t,n,o,s,i,a){var c={$$typeof:r,type:e,key:t,ref:n,props:a,_owner:i,_store:{}};return Object.defineProperty(c._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:!1}),Object.defineProperty(c,"_self",{configurable:!1,enumerable:!1,writable:!1,value:o}),Object.defineProperty(c,"_source",{configurable:!1,enumerable:!1,writable:!1,value:s}),Object.freeze&&(Object.freeze(c.props),Object.freeze(c)),c}(e,c,l,s,o,X.current,a)}(e,n,o,y,b);if(null==E)return E;if(x){var O=n.children;if(void 0!==O)if(m)if(B(O)){for(var k=0;k<O.length;k++)se(O[k],e);Object.freeze&&Object.freeze(O)}else v("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else se(O,e)}if(A.call(n,"key")){var j=w(e),C=Object.keys(n).filter(function(e){return"key"!==e}),_=C.length>0?"{key: someKey, "+C.join(": ..., ")+": ...}":"{key: someKey}";ie[j+_]||(v('A props object containing a "key" prop is being spread into JSX:\n  let props = %s;\n  <%s {...props} />\nReact keys must be passed directly to JSX without using spread:\n  let props = %s;\n  <%s key={someKey} {...props} />',_,j,C.length>0?"{"+C.join(": ..., ")+": ...}":"{}",j),ie[j+_]=!0)}return e===s?function(e){for(var t=Object.keys(e.props),n=0;n<t.length;n++){var r=t[n];if("children"!==r&&"key"!==r){ee(e),v("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",r),ee(null);break}}null!==e.ref&&(ee(e),v("Invalid attribute `ref` supplied to `React.Fragment`."),ee(null))}(E):function(e){var t,n=e.type;if(null!=n&&"string"!=typeof n){if("function"==typeof n)t=n.propTypes;else{if("object"!=typeof n||n.$$typeof!==u&&n.$$typeof!==h)return;t=n.propTypes}if(t){var r=w(n);!function(e,t,n,r,o){var s=Function.call.bind(A);for(var i in e)if(s(e,i)){var a=void 0;try{if("function"!=typeof e[i]){var c=Error((r||"React class")+": "+n+" type `"+i+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof e[i]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw c.name="Invariant Violation",c}a=e[i](t,i,r,n,null,"SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED")}catch(l){a=l}!a||a instanceof Error||(U(o),v("%s: type specification of %s `%s` is invalid; the type checker function must return `null` or an `Error` but returned a %s. You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument).",r||"React class",n,i,typeof a),U(null)),a instanceof Error&&!(a.message in F)&&(F[a.message]=!0,U(o),v("Failed %s type: %s",n,a.message),U(null))}}(t,e.props,"prop",r,e)}else void 0===n.PropTypes||Y||(Y=!0,v("Component %s declared `PropTypes` instead of `propTypes`. Did you misspell the property assignment?",w(n)||"Unknown"));"function"!=typeof n.getDefaultProps||n.getDefaultProps.isReactClassApproved||v("getDefaultProps is only used on classic React.createClass definitions. Use a static property named `defaultProps` instead.")}}(E),E}On.Fragment=s,On.jsx=function(e,t,n){return ae(e,t,n,!1)},On.jsxs=function(e,t,n){return ae(e,t,n,!0)}}()),On)),Nn.exports);const jn={},Cn=(e,t,n,r)=>{Tn(n)&&jn[n]||(Tn(n)&&(jn[n]=new Date),((e,t,n,r)=>{var o,s,i,a;const c=[n,l({code:t},r||{})];if(null==(s=null==(o=null==e?void 0:e.services)?void 0:o.logger)?void 0:s.forward)return e.services.logger.forward(c,"warn","react-i18next::",!0);Tn(c[0])&&(c[0]=`react-i18next:: ${c[0]}`),(null==(a=null==(i=null==e?void 0:e.services)?void 0:i.logger)?void 0:a.warn)?e.services.logger.warn(...c):null==console||console.warn})(e,t,n,r))},_n=(e,t)=>()=>{if(e.isInitialized)t();else{const n=()=>{setTimeout(()=>{e.off("initialized",n)},0),t()};e.on("initialized",n)}},Mn=(e,t,n)=>{e.loadNamespaces(t,_n(e,n))},Rn=(e,t,n,r)=>{if(Tn(n)&&(n=[n]),e.options.preload&&e.options.preload.indexOf(t)>-1)return Mn(e,n,r);n.forEach(t=>{e.options.ns.indexOf(t)<0&&e.options.ns.push(t)}),e.loadLanguages(t,_n(e,r))},Tn=e=>"string"==typeof e,Pn=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,Dn={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"©","&#169;":"©","&reg;":"®","&#174;":"®","&hellip;":"…","&#8230;":"…","&#x2F;":"/","&#47;":"/"},Ln=e=>Dn[e];let In,$n={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:e=>e.replace(Pn,Ln)};const zn={type:"3rdParty",init(e){((e={})=>{$n=l(l({},$n),e)})(e.options.react),(e=>{In=e})(e)}},An=e.createContext();class Fn{constructor(){this.usedNamespaces={}}addUsedNamespaces(e){e.forEach(e=>{this.usedNamespaces[e]||(this.usedNamespaces[e]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const Vn=(e,t,n,r)=>e.getFixedT(t,n,r),Un=(t,n={})=>{var r,o,s,i;const{i18n:a}=n,{i18n:c,defaultNS:u}=e.useContext(An)||{},d=a||c||In;if(d&&!d.reportNamespaces&&(d.reportNamespaces=new Fn),!d){Cn(d,"NO_I18NEXT_INSTANCE","useTranslation: You will need to pass in an i18next instance by using initReactI18next");const e=(e,t)=>{return Tn(t)?t:"object"==typeof(n=t)&&null!==n&&Tn(t.defaultValue)?t.defaultValue:Array.isArray(e)?e[e.length-1]:e;var n},t=[e,{},!1];return t.t=e,t.i18n={},t.ready=!1,t}(null==(r=d.options.react)?void 0:r.wait)&&Cn(d,"DEPRECATED_OPTION","useTranslation: It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const p=l(l(l({},$n),d.options.react),n),{useSuspense:h,keyPrefix:f}=p;let g=u||(null==(o=d.options)?void 0:o.defaultNS);g=Tn(g)?[g]:g||["translation"],null==(i=(s=d.reportNamespaces).addUsedNamespaces)||i.call(s,g);const m=(d.isInitialized||d.initializedStoreOnce)&&g.every(e=>((e,t,n={})=>t.languages&&t.languages.length?t.hasLoadedNamespace(e,{lng:n.lng,precheck:(t,r)=>{if(n.bindI18n&&n.bindI18n.indexOf("languageChanging")>-1&&t.services.backendConnector.backend&&t.isLanguageChangingTo&&!r(t.isLanguageChangingTo,e))return!1}}):(Cn(t,"NO_LANGUAGES","i18n.languages were undefined or empty",{languages:t.languages}),!0))(e,d,p)),y=((t,n,r,o)=>e.useCallback(Vn(t,n,r,o),[t,n,r,o]))(d,n.lng||null,"fallback"===p.nsMode?g:g[0],f),v=()=>y,b=()=>Vn(d,n.lng||null,"fallback"===p.nsMode?g:g[0],f),[w,x]=e.useState(v);let S=g.join();n.lng&&(S=`${n.lng}${S}`);const N=(t=>{const n=e.useRef();return e.useEffect(()=>{n.current=t},[t,void 0]),n.current})(S),E=e.useRef(!0);e.useEffect(()=>{const{bindI18n:e,bindI18nStore:t}=p;E.current=!0,m||h||(n.lng?Rn(d,n.lng,g,()=>{E.current&&x(b)}):Mn(d,g,()=>{E.current&&x(b)})),m&&N&&N!==S&&E.current&&x(b);const r=()=>{E.current&&x(b)};return e&&(null==d||d.on(e,r)),t&&(null==d||d.store.on(t,r)),()=>{E.current=!1,d&&e&&(null==e||e.split(" ").forEach(e=>d.off(e,r))),t&&d&&t.split(" ").forEach(e=>d.store.off(e,r))}},[d,S]),e.useEffect(()=>{E.current&&m&&x(v)},[d,f,m]);const O=[w,d,m];if(O.t=w,O.i18n=d,O.ready=m,m)return O;if(!m&&!h)return O;throw new Promise(e=>{n.lng?Rn(d,n.lng,g,()=>e()):Mn(d,g,()=>e())})};
/**
   * @license lucide-react v0.364.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   */
var Wn={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
   * @license lucide-react v0.364.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   */const Bn=(t,n)=>{const r=e.forwardRef((r,o)=>{var s,i=r,{color:a="currentColor",size:c=24,strokeWidth:p=2,absoluteStrokeWidth:h,className:f="",children:g}=i,m=d(i,["color","size","strokeWidth","absoluteStrokeWidth","className","children"]);return e.createElement("svg",l(u(l({ref:o},Wn),{width:c,height:c,stroke:a,strokeWidth:h?24*Number(p)/Number(c):p,className:["lucide",`lucide-${s=t,s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,f].join(" ")}),m),[...n.map(([t,n])=>e.createElement(t,n)),...Array.isArray(g)?g:[g]])});return r.displayName=`${t}`,r},qn=Bn("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),Hn=Bn("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Kn=Bn("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Jn=Bn("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),Yn=Bn("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]),Xn=Bn("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),Gn=Bn("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),Qn=Bn("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),Zn=Bn("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),er=Bn("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]),tr=Bn("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]),nr=Bn("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]),rr=Bn("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),or=Bn("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),sr=Bn("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),ir=Bn("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]),ar=Bn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),cr=({onMinimize:e,onClose:t,connectionStatus:n})=>{const{t:r}=Un(),{currentConversation:o,isTyping:s,typingUser:i}=B(e=>e.chat),{branding:a}=B(e=>e.theme);return kn.jsx("div",{className:"chat-header",children:kn.jsxs("div",{className:"chat-header-content",children:[kn.jsxs("div",{className:"chat-header-info",children:[kn.jsx("div",{className:"chat-header-avatar",children:(null==(c=null==o?void 0:o.assignedAgent)?void 0:c.avatar)?kn.jsx("img",{src:o.assignedAgent.avatar,alt:o.assignedAgent.name,className:"w-8 h-8 rounded-full"}):(null==o?void 0:o.assignedAgent)?kn.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-500 flex items-center justify-center",children:kn.jsx(or,{size:16,className:"text-white"})}):a.logo?kn.jsx("img",{src:a.logo,alt:a.companyName||r("widget.title"),className:"w-8 h-8 rounded-full"}):kn.jsx("div",{className:"w-8 h-8 rounded-full bg-primary flex items-center justify-center",children:kn.jsx(qn,{size:16,className:"text-white"})})}),kn.jsxs("div",{className:"chat-header-text",children:[kn.jsx("h3",{className:"chat-header-title",children:a.companyName||r("widget.title")}),kn.jsxs("div",{className:"chat-header-status",children:[(()=>{switch(n){case"connected":return kn.jsx(ir,{size:16,className:"text-green-500"});case"connecting":return kn.jsx(ir,{size:16,className:"text-yellow-500 animate-pulse"});case"error":return kn.jsx(Hn,{size:16,className:"text-red-500"});default:return kn.jsx(sr,{size:16,className:"text-gray-500"})}})(),kn.jsx("span",{className:"chat-header-status-text",children:(()=>{if(s&&i)return`${i} ${r("widget.typing")}`;if(null==o?void 0:o.assignedAgent)return o.assignedAgent.name;switch(n){case"connected":return r("widget.online");case"connecting":return r("widget.connecting");default:return r("widget.offline")}})()})]})]})]}),kn.jsxs("div",{className:"chat-header-actions",children:[kn.jsx("button",{className:"chat-header-button",onClick:e,"aria-label":r("widget.minimize"),title:r("widget.minimize"),children:kn.jsx(er,{size:16})}),kn.jsx("button",{className:"chat-header-button",onClick:t,"aria-label":r("widget.close"),title:r("widget.close"),children:kn.jsx(ar,{size:16})})]})]})});var c},lr=43200,ur=Symbol.for("constructDateFrom");
/**
   * @license lucide-react v0.364.0 - ISC
   *
   * This source code is licensed under the ISC license.
   * See the LICENSE file in the root directory of this source tree.
   */function dr(e,t){return"function"==typeof e?e(t):e&&"object"==typeof e&&ur in e?e[ur](t):e instanceof Date?new e.constructor(t):new Date(t)}function pr(e,t){return dr(e,e)}let hr={};function fr(e){const t=pr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function gr(e,...t){const n=dr.bind(null,e||t.find(e=>"object"==typeof e));return t.map(n)}function mr(e,t){const n=+pr(e)-+pr(t);return n<0?-1:n>0?1:n}function yr(e,t,n){const[r,o,s]=gr(null==n?void 0:n.in,e,e,t),i=mr(o,s),a=Math.abs(function(e,t){const[n,r]=gr(void 0,e,t);return 12*(n.getFullYear()-r.getFullYear())+(n.getMonth()-r.getMonth())}(o,s));if(a<1)return 0;1===o.getMonth()&&o.getDate()>27&&o.setDate(30),o.setMonth(o.getMonth()-i*a);let c=mr(o,s)===-i;(function(e){const t=pr(e);return+function(e){const t=pr(e);return t.setHours(23,59,59,999),t}(t)===+function(e){const t=pr(e),n=t.getMonth();return t.setFullYear(t.getFullYear(),n+1,0),t.setHours(23,59,59,999),t}(t)})(r)&&1===a&&1===mr(r,s)&&(c=!1);const l=i*(a-+c);return 0===l?0:l}const vr={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}};function br(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const wr={date:br({formats:{full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},defaultWidth:"full"}),time:br({formats:{full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},defaultWidth:"full"}),dateTime:br({formats:{full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},defaultWidth:"full"})},xr={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"};function Sr(e){return(t,n)=>{let r;if("formatting"===((null==n?void 0:n.context)?String(n.context):"standalone")&&e.formattingValues){const t=e.defaultFormattingWidth||e.defaultWidth,o=(null==n?void 0:n.width)?String(n.width):t;r=e.formattingValues[o]||e.formattingValues[t]}else{const t=e.defaultWidth,o=(null==n?void 0:n.width)?String(n.width):e.defaultWidth;r=e.values[o]||e.values[t]}return r[e.argumentCallback?e.argumentCallback(t):t]}}function Nr(e){return(t,n={})=>{const r=n.width,o=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],s=t.match(o);if(!s)return null;const i=s[0],a=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],c=Array.isArray(a)?function(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}(a,e=>e.test(i)):function(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}(a,e=>e.test(i));let l;return l=e.valueCallback?e.valueCallback(c):c,l=n.valueCallback?n.valueCallback(l):l,{value:l,rest:t.slice(i.length)}}}var Er;const Or={code:"en-US",formatDistance:(e,t,n)=>{let r;const o=vr[e];return r="string"==typeof o?o:1===t?o.one:o.other.replace("{{count}}",t.toString()),(null==n?void 0:n.addSuffix)?n.comparison&&n.comparison>0?"in "+r:r+" ago":r},formatLong:wr,formatRelative:(e,t,n,r)=>xr[e],localize:{ordinalNumber:(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},era:Sr({values:{narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},defaultWidth:"wide"}),quarter:Sr({values:{narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},defaultWidth:"wide",argumentCallback:e=>e-1}),month:Sr({values:{narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},defaultWidth:"wide"}),day:Sr({values:{narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},defaultWidth:"wide"}),dayPeriod:Sr({values:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},defaultWidth:"wide",formattingValues:{narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},defaultFormattingWidth:"wide"})},match:{ordinalNumber:(Er={matchPattern:/^(\d+)(th|st|nd|rd)?/i,parsePattern:/\d+/i,valueCallback:e=>parseInt(e,10)},(e,t={})=>{const n=e.match(Er.matchPattern);if(!n)return null;const r=n[0],o=e.match(Er.parsePattern);if(!o)return null;let s=Er.valueCallback?Er.valueCallback(o[0]):o[0];return s=t.valueCallback?t.valueCallback(s):s,{value:s,rest:e.slice(r.length)}}),era:Nr({matchPatterns:{narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},defaultMatchWidth:"wide",parsePatterns:{any:[/^b/i,/^(a|c)/i]},defaultParseWidth:"any"}),quarter:Nr({matchPatterns:{narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},defaultMatchWidth:"wide",parsePatterns:{any:[/1/i,/2/i,/3/i,/4/i]},defaultParseWidth:"any",valueCallback:e=>e+1}),month:Nr({matchPatterns:{narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},defaultParseWidth:"any"}),day:Nr({matchPatterns:{narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},defaultMatchWidth:"wide",parsePatterns:{narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},defaultParseWidth:"any"}),dayPeriod:Nr({matchPatterns:{narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},defaultMatchWidth:"any",parsePatterns:{any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},defaultParseWidth:"any"})},options:{weekStartsOn:0,firstWeekContainsDate:1}};function kr(e,t,n){var r,o;const s=hr,i=null!=(o=null!=(r=null==n?void 0:n.locale)?r:s.locale)?o:Or,a=mr(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const c=Object.assign({},n,{addSuffix:null==n?void 0:n.addSuffix,comparison:a}),[l,u]=gr(null==n?void 0:n.in,...a>0?[t,e]:[e,t]),d=function(e,t,n){const r=function(e,t){return+pr(e)-+pr(t)}(e,t)/1e3;return(o=null==n?void 0:n.roundingMethod,e=>{const t=(o?Math[o]:Math.trunc)(e);return 0===t?0:t})(r);var o}(u,l),p=(fr(u)-fr(l))/1e3,h=Math.round((d-p)/60);let f;if(h<2)return(null==n?void 0:n.includeSeconds)?d<5?i.formatDistance("lessThanXSeconds",5,c):d<10?i.formatDistance("lessThanXSeconds",10,c):d<20?i.formatDistance("lessThanXSeconds",20,c):d<40?i.formatDistance("halfAMinute",0,c):d<60?i.formatDistance("lessThanXMinutes",1,c):i.formatDistance("xMinutes",1,c):0===h?i.formatDistance("lessThanXMinutes",1,c):i.formatDistance("xMinutes",h,c);if(h<45)return i.formatDistance("xMinutes",h,c);if(h<90)return i.formatDistance("aboutXHours",1,c);if(h<1440){const e=Math.round(h/60);return i.formatDistance("aboutXHours",e,c)}if(h<2520)return i.formatDistance("xDays",1,c);if(h<lr){const e=Math.round(h/1440);return i.formatDistance("xDays",e,c)}if(h<86400)return f=Math.round(h/lr),i.formatDistance("aboutXMonths",f,c);if(f=yr(u,l),f<12){const e=Math.round(h/lr);return i.formatDistance("xMonths",e,c)}{const e=f%12,t=Math.trunc(f/12);return e<3?i.formatDistance("aboutXYears",t,c):e<9?i.formatDistance("overXYears",t,c):i.formatDistance("almostXYears",t+1,c)}}const jr=({message:e,isFirstInGroup:t,isLastInGroup:n,showAvatar:r})=>{const{t:o}=Un(),{currentConversation:s}=B(e=>e.chat),{branding:i,isRTL:a}=B(e=>e.theme),c="user"===e.sender,l="agent"===e.sender,u=()=>c?o("accessibility.userMessage"):l&&(null==s?void 0:s.assignedAgent)?s.assignedAgent.name:l?"Agent":i.companyName||"Bot";return kn.jsx("div",{className:["message-bubble",{user:"message-user",bot:"message-bot",agent:"message-agent"}[e.sender],t&&"first-in-group",n&&"last-in-group",a&&"rtl"].filter(Boolean).join(" "),children:kn.jsxs("div",{className:"message-content",children:[r&&!c&&kn.jsx("div",{className:"message-avatar-container",children:c?kn.jsx("div",{className:"message-avatar user-avatar",children:kn.jsx(or,{size:16})}):l&&(null==(f=null==s?void 0:s.assignedAgent)?void 0:f.avatar)?kn.jsx("img",{src:s.assignedAgent.avatar,alt:s.assignedAgent.name,className:"message-avatar agent-avatar"}):l?kn.jsx("div",{className:"message-avatar agent-avatar",children:kn.jsx(rr,{size:16})}):i.logo?kn.jsx("img",{src:i.logo,alt:i.companyName||o("widget.title"),className:"message-avatar bot-avatar"}):kn.jsx("div",{className:"message-avatar bot-avatar",children:kn.jsx(qn,{size:16})})}),kn.jsxs("div",{className:"message-body",children:[t&&!c&&kn.jsx("div",{className:"message-sender",children:u()}),kn.jsx("div",{className:"message-bubble-content",role:"article","aria-label":`${u()}: ${e.content}`,children:(()=>{switch(e.type){case"file":return(()=>{const{fileName:t,fileSize:n,fileType:r}=e.metadata||{};return kn.jsxs("div",{className:"message-file",children:[kn.jsx("div",{className:"file-icon",children:(null==r?void 0:r.startsWith("image/"))?kn.jsx(Yn,{size:20}):kn.jsx(Jn,{size:20})}),kn.jsxs("div",{className:"file-info",children:[kn.jsx("div",{className:"file-name",children:t}),n&&kn.jsxs("div",{className:"file-size",children:[(n/1024/1024).toFixed(2)," MB"]})]}),kn.jsx("button",{className:"file-download","aria-label":o("widget.downloadFile"),children:kn.jsx(Kn,{size:16})})]})})();case"image":return(()=>{const{imageUrl:t,fileName:n}=e.metadata||{};return kn.jsx("div",{className:"message-image",children:kn.jsx("img",{src:t,alt:n||"Uploaded image",className:"message-image-content",loading:"lazy"})})})();default:return kn.jsx("div",{className:"message-text",children:e.content})}})()}),n&&kn.jsx("div",{className:"message-timestamp",children:kn.jsx("time",{dateTime:e.timestamp.toISOString(),children:(h=e.timestamp,d=h,p={addSuffix:!0},kr(d,function(e){return dr(e,Date.now())}(d),p))})})]})]})});var d,p,h,f},Cr=({user:e})=>{var t;const{t:n}=Un(),{currentConversation:r}=B(e=>e.chat),{branding:o}=B(e=>e.theme),s=(null==(t=null==r?void 0:r.assignedAgent)?void 0:t.name)===e;return kn.jsx("div",{className:"typing-indicator",role:"status","aria-live":"polite",children:kn.jsxs("div",{className:"typing-content",children:[kn.jsx("div",{className:"typing-avatar-container",children:s&&(null==(i=null==r?void 0:r.assignedAgent)?void 0:i.avatar)?kn.jsx("img",{src:r.assignedAgent.avatar,alt:r.assignedAgent.name,className:"typing-avatar"}):s?kn.jsx("div",{className:"typing-avatar agent-avatar",children:kn.jsx(rr,{size:16})}):o.logo?kn.jsx("img",{src:o.logo,alt:o.companyName||n("widget.title"),className:"typing-avatar"}):kn.jsx("div",{className:"typing-avatar bot-avatar",children:kn.jsx(qn,{size:16})})}),kn.jsxs("div",{className:"typing-bubble",children:[kn.jsxs("div",{className:"typing-text",children:[kn.jsx("span",{className:"typing-user",children:e}),kn.jsx("span",{className:"typing-message",children:n("widget.typing")})]}),kn.jsxs("div",{className:"typing-dots",children:[kn.jsx("div",{className:"typing-dot"}),kn.jsx("div",{className:"typing-dot"}),kn.jsx("div",{className:"typing-dot"})]})]})]})});var i},_r=()=>{const{t:t}=Un(),n=e.useRef(null),{currentConversation:r,isTyping:o,typingUser:s}=B(e=>e.chat),{branding:i}=B(e=>e.theme),a=(null==r?void 0:r.messages)||[];e.useEffect(()=>{c()},[a,o]);const c=()=>{var e;null==(e=n.current)||e.scrollIntoView({behavior:"smooth"})};return kn.jsxs("div",{className:"message-list",role:"log","aria-label":t("accessibility.messageList"),"aria-live":"polite",children:[0===a.length?kn.jsxs("div",{className:"message-list-empty",children:[kn.jsx("div",{className:"empty-state-avatar",children:i.logo?kn.jsx("img",{src:i.logo,alt:i.companyName||t("widget.title"),className:"w-12 h-12 rounded-full"}):kn.jsx("div",{className:"w-12 h-12 rounded-full bg-primary flex items-center justify-center",children:kn.jsx(qn,{size:24,className:"text-white"})})}),kn.jsxs("div",{className:"empty-state-content",children:[kn.jsx("h3",{className:"empty-state-title",children:i.companyName||t("widget.title")}),kn.jsx("p",{className:"empty-state-message",children:i.welcomeMessage||t("widget.welcomeMessage")})]})]}):kn.jsxs(kn.Fragment,{children:[kn.jsx("div",{className:"conversation-start",children:kn.jsx("div",{className:"conversation-start-line",children:kn.jsx("span",{className:"conversation-start-text",children:t("widget.startConversation")})})}),kn.jsxs("div",{className:"messages-container",children:[a.map((e,t)=>{var n;const r=0===t||a[t-1].sender!==e.sender,o=t===a.length-1||(null==(n=a[t+1])?void 0:n.sender)!==e.sender;return kn.jsx(jr,{message:e,isFirstInGroup:r,isLastInGroup:o,showAvatar:o},e.id)}),o&&s&&kn.jsx(Cr,{user:s})]})]}),kn.jsx("div",{ref:n})]})},Mr=new class{constructor(){p(this,"ws",null),p(this,"reconnectAttempts",0),p(this,"maxReconnectAttempts",5),p(this,"reconnectDelay",1e3),p(this,"heartbeatInterval",null)}connect(e,t){const n=bn.getState(),{websocketUrl:r}=n.config.widget,{sessionId:o,userId:s}=n.config,i=new URL(r,window.location.origin);i.searchParams.set("tenantId",e),i.searchParams.set("sessionId",o),t&&i.searchParams.set("conversationId",t),s&&i.searchParams.set("userId",s);try{bn.dispatch(Yt("connecting")),this.ws=new WebSocket(i.toString()),this.setupEventListeners()}catch(a){bn.dispatch(Yt("error")),this.scheduleReconnect()}}setupEventListeners(){this.ws&&(this.ws.onopen=()=>{bn.dispatch(Yt("connected")),this.reconnectAttempts=0,this.startHeartbeat()},this.ws.onmessage=e=>{try{const t=JSON.parse(e.data);this.handleMessage(t)}catch(t){}},this.ws.onclose=e=>{bn.dispatch(Yt("disconnected")),this.stopHeartbeat(),1e3!==e.code&&this.scheduleReconnect()},this.ws.onerror=e=>{bn.dispatch(Yt("error"))})}handleMessage(e){switch(e.type){case"message":bn.dispatch(Kt({id:e.id,content:e.content,sender:e.sender,timestamp:new Date(e.timestamp),type:e.messageType||"text",metadata:e.metadata}));break;case"typing":bn.dispatch(Jt({isTyping:e.isTyping,user:e.user}));break;case"agent_assigned":bn.dispatch(Gt({id:e.agent.id,name:e.agent.name,avatar:e.agent.avatar}));break;case"conversation_status":bn.dispatch(Xt(e.status))}}sendMessage(e,t="text",n){if(this.ws&&this.ws.readyState===WebSocket.OPEN){const r={type:"message",content:e,messageType:t,metadata:n,timestamp:(new Date).toISOString()};this.ws.send(JSON.stringify(r))}}sendTyping(e){this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify({type:"typing",isTyping:e}))}requestAgent(){this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify({type:"request_agent"}))}startHeartbeat(){this.heartbeatInterval=window.setInterval(()=>{this.ws&&this.ws.readyState===WebSocket.OPEN&&this.ws.send(JSON.stringify({type:"ping"}))},3e4)}stopHeartbeat(){this.heartbeatInterval&&(window.clearInterval(this.heartbeatInterval),this.heartbeatInterval=null)}scheduleReconnect(){if(this.reconnectAttempts<this.maxReconnectAttempts){this.reconnectAttempts++;const e=this.reconnectDelay*Math.pow(2,this.reconnectAttempts-1);setTimeout(()=>{var e;const t=bn.getState(),{tenantId:n}=t.config.widget,r=null==(e=t.chat.currentConversation)?void 0:e.id;this.connect(n,r)},e)}}disconnect(){this.stopHeartbeat(),this.ws&&(this.ws.close(1e3,"User disconnected"),this.ws=null)}isConnected(){var e;return(null==(e=this.ws)?void 0:e.readyState)===WebSocket.OPEN}},Rr=()=>{const{t:t}=Un(),n=V(),r=e.useRef(null),o=e.useRef(null),[s,i]=e.useState(""),[a,c]=e.useState(!1),[l,u]=e.useState(null),{currentConversation:d,isLoading:p,connectionStatus:f}=B(e=>e.chat),{branding:g}=B(e=>e.theme),{widget:m}=B(e=>e.config),y="connected"===f,v=y&&!p&&s.trim().length>0,b=m.behavior.maxMessageLength;e.useEffect(()=>{r.current&&r.current.focus()},[]);const w=()=>h(null,null,function*(){if(!v)return;const e=s.trim();i(""),Mr.sendTyping(!1),l&&(clearTimeout(l),u(null));try{yield n(At({content:e,type:"text"})).unwrap(),n(vn({event:"message_sent",data:{type:"text",length:e.length}}))}catch(t){}});return e.useEffect(()=>{r.current&&(r.current.style.height="auto",r.current.style.height=`${Math.min(r.current.scrollHeight,120)}px`)},[s]),kn.jsxs("div",{className:"message-input-container",children:[m.features.agentHandoff&&!(null==d?void 0:d.assignedAgent)&&kn.jsx("div",{className:"input-actions-top",children:kn.jsxs("button",{className:"action-button agent-request",onClick:()=>{d&&(n(Vt(d.id)),n(vn({event:"agent_requested"})))},disabled:!y,title:t("widget.requestAgent"),children:[kn.jsx(or,{size:16}),kn.jsx("span",{children:t("widget.requestAgent")})]})}),kn.jsxs("div",{className:"message-input-wrapper",children:[kn.jsxs("div",{className:"input-container",children:[m.features.fileUpload&&kn.jsx("button",{className:"input-action-button",onClick:()=>{var e;return null==(e=o.current)?void 0:e.click()},disabled:!y,"aria-label":t("widget.attachFile"),title:t("widget.attachFile"),children:kn.jsx(tr,{size:18})}),kn.jsx("textarea",{ref:r,value:s,onChange:e=>{const t=e.target.value;if(t.length<=b)if(i(t),t.length>0){Mr.sendTyping(!0),l&&clearTimeout(l);const e=setTimeout(()=>{Mr.sendTyping(!1)},1e3);u(e)}else Mr.sendTyping(!1),l&&(clearTimeout(l),u(null))},onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),w())},placeholder:g.placeholderText||t("widget.placeholder"),className:"message-textarea",disabled:!y,maxLength:b,rows:1,"aria-label":t("accessibility.messageInput")}),kn.jsxs("div",{className:"input-actions",children:[m.features.voiceMessages&&kn.jsx("button",{className:"input-action-button voice-button "+(a?"recording":""),onClick:()=>{a?(c(!1),n(vn({event:"voice_recording_stopped"}))):(c(!0),n(vn({event:"voice_recording_started"})))},disabled:!y,"aria-label":t(a?"widget.stopRecording":"widget.recordVoice"),title:t(a?"widget.stopRecording":"widget.recordVoice"),children:a?kn.jsx(Qn,{size:18}):kn.jsx(Zn,{size:18})}),kn.jsx("button",{className:"send-button",onClick:w,disabled:!v,"aria-label":t("widget.sendMessage"),title:t("widget.sendMessage"),children:kn.jsx(nr,{size:18})})]})]}),s.length>0&&kn.jsx("div",{className:"character-count",children:kn.jsxs("span",{className:s.length>.9*b?"warning":"",children:[s.length,"/",b]})})]}),kn.jsx("input",{ref:o,type:"file",onChange:e=>{var r;const o=null==(r=e.target.files)?void 0:r[0];o&&(o.size>m.behavior.maxFileSize?alert(t("errors.fileTooLarge",{maxSize:m.behavior.maxFileSize/1024/1024})):m.behavior.allowedFileTypes.some(e=>e.startsWith(".")?o.name.toLowerCase().endsWith(e.toLowerCase()):o.type.match(e))?n(vn({event:"file_upload_started",data:{fileName:o.name,fileSize:o.size,fileType:o.type}})):alert(t("errors.fileTypeNotAllowed")))},accept:m.behavior.allowedFileTypes.join(","),style:{display:"none"}})]})},Tr=({onClick:e,unreadCount:t,isConnected:n})=>{const{t:r}=Un(),{branding:o}=B(e=>e.theme);return kn.jsxs("button",{className:"chat-button",onClick:e,"aria-label":r("widget.startConversation"),title:r("widget.startConversation"),children:[kn.jsxs("div",{className:"chat-button-content",children:[o.logo?kn.jsx("img",{src:o.logo,alt:o.companyName||r("widget.title"),className:"chat-button-logo"}):kn.jsx(Gn,{size:24,className:"chat-button-icon"}),t>0&&kn.jsx("span",{className:"unread-badge","aria-label":`${t} unread messages`,children:t>99?"99+":t}),kn.jsx("div",{className:"connection-indicator",children:n?kn.jsx(ir,{size:12,className:"connection-icon connected"}):kn.jsx(sr,{size:12,className:"connection-icon disconnected"})})]}),o.welcomeMessage&&kn.jsx("div",{className:"chat-button-tooltip",children:o.welcomeMessage})]})},Pr=({status:e})=>{const{t:t}=Un();if("connected"===e)return null;const n=(()=>{switch(e){case"connecting":return{icon:kn.jsx(Xn,{size:16,className:"animate-spin"}),text:t("status.connecting"),className:"status-connecting"};case"disconnected":default:return{icon:kn.jsx(sr,{size:16}),text:t("status.disconnected"),className:"status-disconnected"};case"error":return{icon:kn.jsx(Hn,{size:16}),text:t("errors.connectionFailed"),className:"status-error"}}})();return kn.jsx("div",{className:`connection-status ${n.className}`,role:"status","aria-live":"polite",children:kn.jsxs("div",{className:"status-content",children:[kn.jsx("div",{className:"status-icon",children:n.icon}),kn.jsx("span",{className:"status-text",children:n.text})]})})},Dr=()=>{const{t:t,i18n:n}=Un(),r=V(),o=e.useRef(null),{isOpen:s,isMinimized:i,unreadCount:a,connectionStatus:c}=B(e=>e.chat),{config:l,isRTL:u,language:d}=B(e=>e.theme),{widget:p,isInitialized:h}=B(e=>e.config);e.useEffect(()=>(h&&p.tenantId&&(Mr.connect(p.tenantId),r(vn({event:"widget_initialized"}))),()=>{Mr.disconnect()}),[h,p.tenantId,r]),e.useEffect(()=>{n.changeLanguage(d),document.documentElement.dir=u?"rtl":"ltr"},[d,u,n]),e.useEffect(()=>{s&&a>0&&r(Zt())},[s,a,r]),e.useEffect(()=>{if(p.behavior.autoOpen&&!s){const e=setTimeout(()=>{r(Wt()),r(vn({event:"widget_auto_opened"}))},p.behavior.autoOpenDelay);return()=>clearTimeout(e)}},[p.behavior.autoOpen,p.behavior.autoOpenDelay,s,r]);const f=()=>{r(qt()),r(vn({event:"widget_maximized"}))};return h?kn.jsx("div",{ref:o,className:["chat-widget",{"bottom-right":"bottom-4 right-4","bottom-left":"bottom-4 left-4","top-right":"top-4 right-4","top-left":"top-4 left-4"}[l.position],s?{small:"w-80 h-96",medium:"w-96 h-[500px]",large:"w-[420px] h-[600px]"}[l.size]:"w-auto h-auto",s&&!i?{slide:"animate-slide-up",fade:"animate-fade-in",bounce:"animate-bounce-in",none:""}[l.animation]:"",u?"rtl":"ltr"].filter(Boolean).join(" "),style:{"--primary-color":l.primaryColor,"--secondary-color":l.secondaryColor,"--background-color":l.backgroundColor,"--text-color":l.textColor,"--border-radius":l.borderRadius,"--font-family":l.fontFamily,"--font-size":l.fontSize,"--header-color":l.headerColor,"--header-text-color":l.headerTextColor,"--user-message-color":l.userMessageColor,"--bot-message-color":l.botMessageColor,"--shadow-color":l.shadowColor},role:"dialog","aria-label":t("accessibility.chatWidget"),"aria-expanded":s,children:s?kn.jsxs("div",{className:"chat-container",children:[!i&&kn.jsxs(kn.Fragment,{children:[kn.jsx(cr,{onMinimize:()=>{r(Bt()),r(vn({event:"widget_minimized"}))},onClose:()=>{r(Ht()),r(vn({event:"widget_closed",data:{source:"close_button"}}))},connectionStatus:c}),kn.jsxs("div",{className:"chat-body",children:[kn.jsx(Pr,{status:c}),kn.jsx(_r,{}),kn.jsx(Rr,{})]})]}),i&&kn.jsx("div",{className:"chat-minimized",onClick:f,role:"button",tabIndex:0,"aria-label":t("widget.maximize"),onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||f()},children:kn.jsxs("div",{className:"minimized-header",children:[kn.jsx("span",{className:"minimized-title",children:t("widget.title")}),a>0&&kn.jsx("span",{className:"unread-badge",children:a})]})})]}):kn.jsx(Tr,{onClick:()=>{r(Wt()),r(vn({event:s?"widget_closed":"widget_opened",data:{source:"user_action"}}))},unreadCount:a,isConnected:"connected"===c})}):null},Lr=e=>"string"==typeof e,Ir=()=>{let e,t;const n=new Promise((n,r)=>{e=n,t=r});return n.resolve=e,n.reject=t,n},$r=e=>null==e?"":""+e,zr=/###/g,Ar=e=>e&&e.indexOf("###")>-1?e.replace(zr,"."):e,Fr=e=>!e||Lr(e),Vr=(e,t,n)=>{const r=Lr(t)?t.split("."):t;let o=0;for(;o<r.length-1;){if(Fr(e))return{};const t=Ar(r[o]);!e[t]&&n&&(e[t]=new n),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++o}return Fr(e)?{}:{obj:e,k:Ar(r[o])}},Ur=(e,t,n)=>{const{obj:r,k:o}=Vr(e,t,Object);if(void 0!==r||1===t.length)return void(r[o]=n);let s=t[t.length-1],i=t.slice(0,t.length-1),a=Vr(e,i,Object);for(;void 0===a.obj&&i.length;)s=`${i[i.length-1]}.${s}`,i=i.slice(0,i.length-1),a=Vr(e,i,Object),(null==a?void 0:a.obj)&&void 0!==a.obj[`${a.k}.${s}`]&&(a.obj=void 0);a.obj[`${a.k}.${s}`]=n},Wr=(e,t)=>{const{obj:n,k:r}=Vr(e,t);if(n&&Object.prototype.hasOwnProperty.call(n,r))return n[r]},Br=(e,t,n)=>{for(const r in t)"__proto__"!==r&&"constructor"!==r&&(r in e?Lr(e[r])||e[r]instanceof String||Lr(t[r])||t[r]instanceof String?n&&(e[r]=t[r]):Br(e[r],t[r],n):e[r]=t[r]);return e},qr=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var Hr={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Kr=e=>Lr(e)?e.replace(/[&<>"'\/]/g,e=>Hr[e]):e,Jr=[" ",",","?","!",";"],Yr=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const n=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,n),this.regExpQueue.push(e),n}}(20),Xr=(e,t,n=".")=>{if(!e)return;if(e[t]){if(!Object.prototype.hasOwnProperty.call(e,t))return;return e[t]}const r=t.split(n);let o=e;for(let s=0;s<r.length;){if(!o||"object"!=typeof o)return;let e,t="";for(let i=s;i<r.length;++i)if(i!==s&&(t+=n),t+=r[i],e=o[t],void 0!==e){if(["string","number","boolean"].indexOf(typeof e)>-1&&i<r.length-1)continue;s+=i-s+1;break}o=e}return o},Gr=e=>null==e?void 0:e.replace("_","-"),Qr={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){var n,r;null==(r=null==(n=null==console?void 0:console[e])?void 0:n.apply)||r.call(n,console,t)}};class Zr{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||Qr,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,n,r){return r&&!this.debug?null:(Lr(e[0])&&(e[0]=`${n}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Zr(this.logger,l(l({},{prefix:`${this.prefix}:${e}:`}),this.options))}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new Zr(this.logger,e)}}var eo=new Zr;class to{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach(e=>{this.observers[e]||(this.observers[e]=new Map);const n=this.observers[e].get(t)||0;this.observers[e].set(t,n+1)}),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e,...t){this.observers[e]&&Array.from(this.observers[e].entries()).forEach(([e,n])=>{for(let r=0;r<n;r++)e(...t)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(([n,r])=>{for(let o=0;o<r;o++)n.apply(n,[e,...t])})}}class no extends to{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,n,r={}){var o,s;const i=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,a=void 0!==r.ignoreJSONStructure?r.ignoreJSONStructure:this.options.ignoreJSONStructure;let c;e.indexOf(".")>-1?c=e.split("."):(c=[e,t],n&&(Array.isArray(n)?c.push(...n):Lr(n)&&i?c.push(...n.split(i)):c.push(n)));const l=Wr(this.data,c);return!l&&!t&&!n&&e.indexOf(".")>-1&&(e=c[0],t=c[1],n=c.slice(2).join(".")),!l&&a&&Lr(n)?Xr(null==(s=null==(o=this.data)?void 0:o[e])?void 0:s[t],n,i):l}addResource(e,t,n,r,o={silent:!1}){const s=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator;let i=[e,t];n&&(i=i.concat(s?n.split(s):n)),e.indexOf(".")>-1&&(i=e.split("."),r=t,t=i[1]),this.addNamespaces(t),Ur(this.data,i,r),o.silent||this.emit("added",e,t,n,r)}addResources(e,t,n,r={silent:!1}){for(const o in n)(Lr(n[o])||Array.isArray(n[o]))&&this.addResource(e,t,o,n[o],{silent:!0});r.silent||this.emit("added",e,t,n)}addResourceBundle(e,t,n,r,o,s={silent:!1,skipCopy:!1}){let i=[e,t];e.indexOf(".")>-1&&(i=e.split("."),r=n,n=t,t=i[1]),this.addNamespaces(t);let a=Wr(this.data,i)||{};s.skipCopy||(n=JSON.parse(JSON.stringify(n))),r?Br(a,n,o):a=l(l({},a),n),Ur(this.data,i,a),s.silent||this.emit("added",e,t,n)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find(e=>t[e]&&Object.keys(t[e]).length>0)}toJSON(){return this.data}}var ro={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,n,r,o){return e.forEach(e=>{var s,i;t=null!=(i=null==(s=this.processors[e])?void 0:s.process(t,n,r,o))?i:t}),t}};const oo={},so=e=>!Lr(e)&&"boolean"!=typeof e&&"number"!=typeof e;class io extends to{constructor(e,t={}){var n,r;super(),n=e,r=this,["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"].forEach(e=>{n[e]&&(r[e]=n[e])}),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=eo.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const n=l({},t);if(null==e)return!1;const r=this.resolve(e,n);return void 0!==(null==r?void 0:r.res)}extractFromKey(e,t){let n=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===n&&(n=":");const r=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let o=t.ns||this.options.defaultNS||[];const s=n&&e.indexOf(n)>-1,i=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||((e,t,n)=>{t=t||"",n=n||"";const r=Jr.filter(e=>t.indexOf(e)<0&&n.indexOf(e)<0);if(0===r.length)return!0;const o=Yr.getRegExp(`(${r.map(e=>"?"===e?"\\?":e).join("|")})`);let s=!o.test(e);if(!s){const t=e.indexOf(n);t>0&&!o.test(e.substring(0,t))&&(s=!0)}return s})(e,n,r));if(s&&!i){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:Lr(o)?[o]:o};const s=e.split(n);(n!==r||n===r&&this.options.ns.indexOf(s[0])>-1)&&(o=s.shift()),e=s.join(r)}return{key:e,namespaces:Lr(o)?[o]:o}}translate(e,t,n){let r="object"==typeof t?l({},t):t;if("object"!=typeof r&&this.options.overloadTranslationOptionHandler&&(r=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof options&&(r=l({},r)),r||(r={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const o=void 0!==r.returnDetails?r.returnDetails:this.options.returnDetails,s=void 0!==r.keySeparator?r.keySeparator:this.options.keySeparator,{key:i,namespaces:a}=this.extractFromKey(e[e.length-1],r),c=a[a.length-1];let d=void 0!==r.nsSeparator?r.nsSeparator:this.options.nsSeparator;void 0===d&&(d=":");const p=r.lng||this.language,h=r.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===(null==p?void 0:p.toLowerCase()))return h?o?{res:`${c}${d}${i}`,usedKey:i,exactUsedKey:i,usedLng:p,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:`${c}${d}${i}`:o?{res:i,usedKey:i,exactUsedKey:i,usedLng:p,usedNS:c,usedParams:this.getUsedParamsDetails(r)}:i;const f=this.resolve(e,r);let g=null==f?void 0:f.res;const m=(null==f?void 0:f.usedKey)||i,y=(null==f?void 0:f.exactUsedKey)||i,v=void 0!==r.joinArrays?r.joinArrays:this.options.joinArrays,b=!this.i18nFormat||this.i18nFormat.handleAsObject,w=void 0!==r.count&&!Lr(r.count),x=io.hasDefaultValue(r),S=w?this.pluralResolver.getSuffix(p,r.count,r):"",N=r.ordinal&&w?this.pluralResolver.getSuffix(p,r.count,{ordinal:!1}):"",E=w&&!r.ordinal&&0===r.count,O=E&&r[`defaultValue${this.options.pluralSeparator}zero`]||r[`defaultValue${S}`]||r[`defaultValue${N}`]||r.defaultValue;let k=g;b&&!g&&x&&(k=O);const j=so(k),C=Object.prototype.toString.apply(k);if(!(b&&k&&j&&["[object Number]","[object Function]","[object RegExp]"].indexOf(C)<0)||Lr(v)&&Array.isArray(k))if(b&&Lr(v)&&Array.isArray(g))g=g.join(v),g&&(g=this.extendTranslation(g,e,r,n));else{let t=!1,o=!1;!this.isValidLookup(g)&&x&&(t=!0,g=O),this.isValidLookup(g)||(o=!0,g=i);const a=(r.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&o?void 0:g,h=x&&O!==g&&this.options.updateMissing;if(o||t||h){if(this.logger.log(h?"updateKey":"missingKey",p,c,i,h?O:g),s){const e=this.resolve(i,u(l({},r),{keySeparator:!1}));e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const t=this.languageUtils.getFallbackCodes(this.options.fallbackLng,r.lng||this.language);if("fallback"===this.options.saveMissingTo&&t&&t[0])for(let r=0;r<t.length;r++)e.push(t[r]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(r.lng||this.language):e.push(r.lng||this.language);const n=(e,t,n)=>{var o;const s=x&&n!==g?n:a;this.options.missingKeyHandler?this.options.missingKeyHandler(e,c,t,s,h,r):(null==(o=this.backendConnector)?void 0:o.saveMissing)&&this.backendConnector.saveMissing(e,c,t,s,h,r),this.emit("missingKey",e,c,t,g)};this.options.saveMissing&&(this.options.saveMissingPlurals&&w?e.forEach(e=>{const t=this.pluralResolver.getSuffixes(e,r);E&&r[`defaultValue${this.options.pluralSeparator}zero`]&&t.indexOf(`${this.options.pluralSeparator}zero`)<0&&t.push(`${this.options.pluralSeparator}zero`),t.forEach(t=>{n([e],i+t,r[`defaultValue${t}`]||O)})}):n(e,i,O))}g=this.extendTranslation(g,e,r,f,n),o&&g===i&&this.options.appendNamespaceToMissingKey&&(g=`${c}${d}${i}`),(o||t)&&this.options.parseMissingKeyHandler&&(g=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${c}${d}${i}`:i,t?g:void 0,r))}else{if(!r.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(m,k,u(l({},r),{ns:a})):`key '${i} (${this.language})' returned an object instead of string.`;return o?(f.res=e,f.usedParams=this.getUsedParamsDetails(r),f):e}if(s){const e=Array.isArray(k),t=e?[]:{},n=e?y:m;for(const o in k)if(Object.prototype.hasOwnProperty.call(k,o)){const e=`${n}${s}${o}`;t[o]=x&&!g?this.translate(e,l(u(l({},r),{defaultValue:so(O)?O[o]:void 0}),{joinArrays:!1,ns:a})):this.translate(e,l(l({},r),{joinArrays:!1,ns:a})),t[o]===e&&(t[o]=k[o])}g=t}}return o?(f.res=g,f.usedParams=this.getUsedParamsDetails(r),f):g}extendTranslation(e,t,n,r,o){var s,i;if(null==(s=this.i18nFormat)?void 0:s.parse)e=this.i18nFormat.parse(e,l(l({},this.options.interpolation.defaultVariables),n),n.lng||this.language||r.usedLng,r.usedNS,r.usedKey,{resolved:r});else if(!n.skipInterpolation){n.interpolation&&this.interpolator.init(l(l({},n),{interpolation:l(l({},this.options.interpolation),n.interpolation)}));const s=Lr(e)&&(void 0!==(null==(i=null==n?void 0:n.interpolation)?void 0:i.skipOnVariables)?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let a;if(s){const t=e.match(this.interpolator.nestingRegexp);a=t&&t.length}let c=n.replace&&!Lr(n.replace)?n.replace:n;if(this.options.interpolation.defaultVariables&&(c=l(l({},this.options.interpolation.defaultVariables),c)),e=this.interpolator.interpolate(e,c,n.lng||this.language||r.usedLng,n),s){const t=e.match(this.interpolator.nestingRegexp);a<(t&&t.length)&&(n.nest=!1)}!n.lng&&r&&r.res&&(n.lng=this.language||r.usedLng),!1!==n.nest&&(e=this.interpolator.nest(e,(...e)=>(null==o?void 0:o[0])!==e[0]||n.context?this.translate(...e,t):(this.logger.warn(`It seems you are nesting recursively key: ${e[0]} in key: ${t[0]}`),null),n)),n.interpolation&&this.interpolator.reset()}const a=n.postProcess||this.options.postProcess,c=Lr(a)?[a]:a;return null!=e&&(null==c?void 0:c.length)&&!1!==n.applyPostProcessor&&(e=ro.handle(c,e,t,this.options&&this.options.postProcessPassResolved?l({i18nResolved:u(l({},r),{usedParams:this.getUsedParamsDetails(n)})},n):n,this)),e}resolve(e,t={}){let n,r,o,s,i;return Lr(e)&&(e=[e]),e.forEach(e=>{if(this.isValidLookup(n))return;const a=this.extractFromKey(e,t),c=a.key;r=c;let l=a.namespaces;this.options.fallbackNS&&(l=l.concat(this.options.fallbackNS));const u=void 0!==t.count&&!Lr(t.count),d=u&&!t.ordinal&&0===t.count,p=void 0!==t.context&&(Lr(t.context)||"number"==typeof t.context)&&""!==t.context,h=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);l.forEach(e=>{var a,l;this.isValidLookup(n)||(i=e,oo[`${h[0]}-${e}`]||!(null==(a=this.utils)?void 0:a.hasLoadedNamespace)||(null==(l=this.utils)?void 0:l.hasLoadedNamespace(i))||(oo[`${h[0]}-${e}`]=!0,this.logger.warn(`key "${r}" for languages "${h.join(", ")}" won't get resolved as namespace "${i}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),h.forEach(r=>{var i;if(this.isValidLookup(n))return;s=r;const a=[c];if(null==(i=this.i18nFormat)?void 0:i.addLookupKeys)this.i18nFormat.addLookupKeys(a,c,r,e,t);else{let e;u&&(e=this.pluralResolver.getSuffix(r,t.count,t));const n=`${this.options.pluralSeparator}zero`,o=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(u&&(a.push(c+e),t.ordinal&&0===e.indexOf(o)&&a.push(c+e.replace(o,this.options.pluralSeparator)),d&&a.push(c+n)),p){const r=`${c}${this.options.contextSeparator}${t.context}`;a.push(r),u&&(a.push(r+e),t.ordinal&&0===e.indexOf(o)&&a.push(r+e.replace(o,this.options.pluralSeparator)),d&&a.push(r+n))}}let l;for(;l=a.pop();)this.isValidLookup(n)||(o=l,n=this.getResource(r,e,l,t))}))})}),{res:n,usedKey:r,exactUsedKey:o,usedLng:s,usedNS:i}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,n,r={}){var o;return(null==(o=this.i18nFormat)?void 0:o.getResource)?this.i18nFormat.getResource(e,t,n,r):this.resourceStore.getResource(e,t,n,r)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],n=e.replace&&!Lr(e.replace);let r=n?e.replace:e;if(n&&void 0!==e.count&&(r.count=e.count),this.options.interpolation.defaultVariables&&(r=l(l({},this.options.interpolation.defaultVariables),r)),!n){r=l({},r);for(const e of t)delete r[e]}return r}static hasDefaultValue(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t)&&"defaultValue"===t.substring(0,12)&&void 0!==e[t])return!0;return!1}}class ao{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=eo.create("languageUtils")}getScriptPartFromCode(e){if(!(e=Gr(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=Gr(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(Lr(e)&&e.indexOf("-")>-1){let n;try{n=Intl.getCanonicalLocales(e)[0]}catch(t){}return n&&this.options.lowerCaseLng&&(n=n.toLowerCase()),n||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach(e=>{if(t)return;const n=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(n)||(t=n)}),!t&&this.options.supportedLngs&&e.forEach(e=>{if(t)return;const n=this.getScriptPartFromCode(e);if(this.isSupportedCode(n))return t=n;const r=this.getLanguagePartFromCode(e);if(this.isSupportedCode(r))return t=r;t=this.options.supportedLngs.find(e=>e===r?e:e.indexOf("-")<0&&r.indexOf("-")<0?void 0:e.indexOf("-")>0&&r.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===r||0===e.indexOf(r)&&r.length>1?e:void 0)}),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),Lr(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let n=e[t];return n||(n=e[this.getScriptPartFromCode(t)]),n||(n=e[this.formatLanguageCode(t)]),n||(n=e[this.getLanguagePartFromCode(t)]),n||(n=e.default),n||[]}toResolveHierarchy(e,t){const n=this.getFallbackCodes((!1===t?[]:t)||this.options.fallbackLng||[],e),r=[],o=e=>{e&&(this.isSupportedCode(e)?r.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return Lr(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(e))):Lr(e)&&o(this.formatLanguageCode(e)),n.forEach(e=>{r.indexOf(e)<0&&o(this.formatLanguageCode(e))}),r}}const co={zero:0,one:1,two:2,few:3,many:4,other:5},lo={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class uo{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=eo.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const n=Gr("dev"===e?"en":e),r=t.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:n,type:r});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let s;try{s=new Intl.PluralRules(n,{type:r})}catch(i){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),lo;if(!e.match(/-|_/))return lo;const n=this.languageUtils.getLanguagePartFromCode(e);s=this.getRule(n,t)}return this.pluralRulesCache[o]=s,s}needsPlural(e,t={}){let n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),(null==n?void 0:n.resolvedOptions().pluralCategories.length)>1}getPluralFormsOfKey(e,t,n={}){return this.getSuffixes(e,n).map(e=>`${t}${e}`)}getSuffixes(e,t={}){let n=this.getRule(e,t);return n||(n=this.getRule("dev",t)),n?n.resolvedOptions().pluralCategories.sort((e,t)=>co[e]-co[t]).map(e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`):[]}getSuffix(e,t,n={}){const r=this.getRule(e,n);return r?`${this.options.prepend}${n.ordinal?`ordinal${this.options.prepend}`:""}${r.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,n))}}const po=(e,t,n,r=".",o=!0)=>{let s=((e,t,n)=>{const r=Wr(e,n);return void 0!==r?r:Wr(t,n)})(e,t,n);return!s&&o&&Lr(n)&&(s=Xr(e,n,r),void 0===s&&(s=Xr(t,n,r))),s},ho=e=>e.replace(/\$/g,"$$$$");class fo{constructor(e={}){var t;this.logger=eo.create("interpolator"),this.options=e,this.format=(null==(t=null==e?void 0:e.interpolation)?void 0:t.format)||(e=>e),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:n,useRawValueToEscape:r,prefix:o,prefixEscaped:s,suffix:i,suffixEscaped:a,formatSeparator:c,unescapeSuffix:l,unescapePrefix:u,nestingPrefix:d,nestingPrefixEscaped:p,nestingSuffix:h,nestingSuffixEscaped:f,nestingOptionsSeparator:g,maxReplaces:m,alwaysFormat:y}=e.interpolation;this.escape=void 0!==t?t:Kr,this.escapeValue=void 0===n||n,this.useRawValueToEscape=void 0!==r&&r,this.prefix=o?qr(o):s||"{{",this.suffix=i?qr(i):a||"}}",this.formatSeparator=c||",",this.unescapePrefix=l?"":u||"-",this.unescapeSuffix=this.unescapePrefix?"":l||"",this.nestingPrefix=d?qr(d):p||qr("$t("),this.nestingSuffix=h?qr(h):f||qr(")"),this.nestingOptionsSeparator=g||",",this.maxReplaces=m||1e3,this.alwaysFormat=void 0!==y&&y,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>(null==e?void 0:e.source)===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,n,r){var o;let s,i,a;const c=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},d=e=>{if(e.indexOf(this.formatSeparator)<0){const o=po(t,c,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(o,void 0,n,u(l(l({},r),t),{interpolationkey:e})):o}const o=e.split(this.formatSeparator),s=o.shift().trim(),i=o.join(this.formatSeparator).trim();return this.format(po(t,c,s,this.options.keySeparator,this.options.ignoreJSONStructure),i,n,u(l(l({},r),t),{interpolationkey:s}))};this.resetRegExp();const p=(null==r?void 0:r.missingInterpolationHandler)||this.options.missingInterpolationHandler,h=void 0!==(null==(o=null==r?void 0:r.interpolation)?void 0:o.skipOnVariables)?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>ho(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?ho(this.escape(e)):ho(e)}].forEach(t=>{for(a=0;s=t.regex.exec(e);){const n=s[1].trim();if(i=d(n),void 0===i)if("function"==typeof p){const t=p(e,s,r);i=Lr(t)?t:""}else if(r&&Object.prototype.hasOwnProperty.call(r,n))i="";else{if(h){i=s[0];continue}this.logger.warn(`missed to pass in variable ${n} for interpolating ${e}`),i=""}else Lr(i)||this.useRawValueToEscape||(i=$r(i));const o=t.safeValue(i);if(e=e.replace(s[0],o),h?(t.regex.lastIndex+=i.length,t.regex.lastIndex-=s[0].length):t.regex.lastIndex=0,a++,a>=this.maxReplaces)break}}),e}nest(e,t,n={}){let r,o,s;const i=(e,t)=>{var n;const r=this.nestingOptionsSeparator;if(e.indexOf(r)<0)return e;const o=e.split(new RegExp(`${r}[ ]*{`));let i=`{${o[1]}`;e=o[0],i=this.interpolate(i,s);const a=i.match(/'/g),c=i.match(/"/g);((null!=(n=null==a?void 0:a.length)?n:0)%2==0&&!c||c.length%2!=0)&&(i=i.replace(/'/g,'"'));try{s=JSON.parse(i),t&&(s=l(l({},t),s))}catch(u){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,u),`${e}${r}${i}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,e};for(;r=this.nestingRegexp.exec(e);){let a=[];s=l({},n),s=s.replace&&!Lr(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;const c=/{.*}/.test(r[1])?r[1].lastIndexOf("}")+1:r[1].indexOf(this.formatSeparator);if(-1!==c&&(a=r[1].slice(c).split(this.formatSeparator).map(e=>e.trim()).filter(Boolean),r[1]=r[1].slice(0,c)),o=t(i.call(this,r[1].trim(),s),s),o&&r[0]===e&&!Lr(o))return o;Lr(o)||(o=$r(o)),o||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),o=""),a.length&&(o=a.reduce((e,t)=>this.format(e,t,n.lng,u(l({},n),{interpolationkey:r[1].trim()})),o.trim())),e=e.replace(r[0],o),this.regexp.lastIndex=0}return e}}const go=e=>{const t={};return(n,r,o)=>{let s=o;o&&o.interpolationkey&&o.formatParams&&o.formatParams[o.interpolationkey]&&o[o.interpolationkey]&&(s=u(l({},s),{[o.interpolationkey]:void 0}));const i=r+JSON.stringify(s);let a=t[i];return a||(a=e(Gr(r),o),t[i]=a),a(n)}},mo=e=>(t,n,r)=>e(Gr(n),r)(t);class yo{constructor(e={}){this.logger=eo.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const n=t.cacheInBuiltFormats?go:mo;this.formats={number:n((e,t)=>{const n=new Intl.NumberFormat(e,l({},t));return e=>n.format(e)}),currency:n((e,t)=>{const n=new Intl.NumberFormat(e,u(l({},t),{style:"currency"}));return e=>n.format(e)}),datetime:n((e,t)=>{const n=new Intl.DateTimeFormat(e,l({},t));return e=>n.format(e)}),relativetime:n((e,t)=>{const n=new Intl.RelativeTimeFormat(e,l({},t));return e=>n.format(e,t.range||"day")}),list:n((e,t)=>{const n=new Intl.ListFormat(e,l({},t));return e=>n.format(e)})}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=go(t)}format(e,t,n,r={}){const o=t.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find(e=>e.indexOf(")")>-1)){const e=o.findIndex(e=>e.indexOf(")")>-1);o[0]=[o[0],...o.splice(1,e)].join(this.formatSeparator)}return o.reduce((e,t)=>{var o;const{formatName:s,formatOptions:i}=(e=>{let t=e.toLowerCase().trim();const n={};if(e.indexOf("(")>-1){const r=e.split("(");t=r[0].toLowerCase().trim();const o=r[1].substring(0,r[1].length-1);"currency"===t&&o.indexOf(":")<0?n.currency||(n.currency=o.trim()):"relativetime"===t&&o.indexOf(":")<0?n.range||(n.range=o.trim()):o.split(";").forEach(e=>{if(e){const[t,...r]=e.split(":"),o=r.join(":").trim().replace(/^'+|'+$/g,""),s=t.trim();n[s]||(n[s]=o),"false"===o&&(n[s]=!1),"true"===o&&(n[s]=!0),isNaN(o)||(n[s]=parseInt(o,10))}})}return{formatName:t,formatOptions:n}})(t);if(this.formats[s]){let t=e;try{const a=(null==(o=null==r?void 0:r.formatParams)?void 0:o[r.interpolationkey])||{},c=a.locale||a.lng||r.locale||r.lng||n;t=this.formats[s](e,c,l(l(l({},i),r),a))}catch(a){this.logger.warn(a)}return t}return this.logger.warn(`there was no format function for ${s}`),e},e)}}class vo extends to{constructor(e,t,n,r={}){var o,s;super(),this.backend=e,this.store=t,this.services=n,this.languageUtils=n.languageUtils,this.options=r,this.logger=eo.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=r.maxParallelReads||10,this.readingCalls=0,this.maxRetries=r.maxRetries>=0?r.maxRetries:5,this.retryTimeout=r.retryTimeout>=1?r.retryTimeout:350,this.state={},this.queue=[],null==(s=null==(o=this.backend)?void 0:o.init)||s.call(o,n,r.backend,r)}queueLoad(e,t,n,r){const o={},s={},i={},a={};return e.forEach(e=>{let r=!0;t.forEach(t=>{const i=`${e}|${t}`;!n.reload&&this.store.hasResourceBundle(e,t)?this.state[i]=2:this.state[i]<0||(1===this.state[i]?void 0===s[i]&&(s[i]=!0):(this.state[i]=1,r=!1,void 0===s[i]&&(s[i]=!0),void 0===o[i]&&(o[i]=!0),void 0===a[t]&&(a[t]=!0)))}),r||(i[e]=!0)}),(Object.keys(o).length||Object.keys(s).length)&&this.queue.push({pending:s,pendingCount:Object.keys(s).length,loaded:{},errors:[],callback:r}),{toLoad:Object.keys(o),pending:Object.keys(s),toLoadLanguages:Object.keys(i),toLoadNamespaces:Object.keys(a)}}loaded(e,t,n){const r=e.split("|"),o=r[0],s=r[1];t&&this.emit("failedLoading",o,s,t),!t&&n&&this.store.addResourceBundle(o,s,n,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&n&&(this.state[e]=0);const i={};this.queue.forEach(n=>{((e,t,n)=>{const{obj:r,k:o}=Vr(e,t,Object);r[o]=r[o]||[],r[o].push(n)})(n.loaded,[o],s),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(n,e),t&&n.errors.push(t),0!==n.pendingCount||n.done||(Object.keys(n.loaded).forEach(e=>{i[e]||(i[e]={});const t=n.loaded[e];t.length&&t.forEach(t=>{void 0===i[e][t]&&(i[e][t]=!0)})}),n.done=!0,n.errors.length?n.callback(n.errors):n.callback())}),this.emit("loaded",i),this.queue=this.queue.filter(e=>!e.done)}read(e,t,n,r=0,o=this.retryTimeout,s){if(!e.length)return s(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:n,tried:r,wait:o,callback:s});this.readingCalls++;const i=(i,a)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}i&&a&&r<this.maxRetries?setTimeout(()=>{this.read.call(this,e,t,n,r+1,2*o,s)},o):s(i,a)},a=this.backend[n].bind(this.backend);if(2!==a.length)return a(e,t,i);try{const n=a(e,t);n&&"function"==typeof n.then?n.then(e=>i(null,e)).catch(i):i(null,n)}catch(c){i(c)}}prepareLoading(e,t,n={},r){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),r&&r();Lr(e)&&(e=this.languageUtils.toResolveHierarchy(e)),Lr(t)&&(t=[t]);const o=this.queueLoad(e,t,n,r);if(!o.toLoad.length)return o.pending.length||r(),null;o.toLoad.forEach(e=>{this.loadOne(e)})}load(e,t,n){this.prepareLoading(e,t,{},n)}reload(e,t,n){this.prepareLoading(e,t,{reload:!0},n)}loadOne(e,t=""){const n=e.split("|"),r=n[0],o=n[1];this.read(r,o,"read",void 0,void 0,(n,s)=>{n&&this.logger.warn(`${t}loading namespace ${o} for language ${r} failed`,n),!n&&s&&this.logger.log(`${t}loaded namespace ${o} for language ${r}`,s),this.loaded(e,n,s)})}saveMissing(e,t,n,r,o,s={},i=()=>{}){var a,c,d,p,h;if(!(null==(c=null==(a=this.services)?void 0:a.utils)?void 0:c.hasLoadedNamespace)||(null==(p=null==(d=this.services)?void 0:d.utils)?void 0:p.hasLoadedNamespace(t))){if(null!=n&&""!==n){if(null==(h=this.backend)?void 0:h.create){const a=u(l({},s),{isUpdate:o}),c=this.backend.create.bind(this.backend);if(c.length<6)try{let o;o=5===c.length?c(e,t,n,r,a):c(e,t,n,r),o&&"function"==typeof o.then?o.then(e=>i(null,e)).catch(i):i(null,o)}catch(f){i(f)}else c(e,t,n,r,i,a)}e&&e[0]&&this.store.addResource(e[0],t,n,r)}}else this.logger.warn(`did not save key "${n}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const bo=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),Lr(e[1])&&(t.defaultValue=e[1]),Lr(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const n=e[3]||e[2];Object.keys(n).forEach(e=>{t[e]=n[e]})}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),wo=e=>{var t,n;return Lr(e.ns)&&(e.ns=[e.ns]),Lr(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),Lr(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),(null==(n=null==(t=e.supportedLngs)?void 0:t.indexOf)?void 0:n.call(t,"cimode"))<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"==typeof e.initImmediate&&(e.initAsync=e.initImmediate),e},xo=()=>{};class So extends to{constructor(e={},t){var n;if(super(),this.options=wo(e),this.services={},this.logger=eo,this.modules={external:[]},n=this,Object.getOwnPropertyNames(Object.getPrototypeOf(n)).forEach(e=>{"function"==typeof n[e]&&(n[e]=n[e].bind(n))}),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout(()=>{this.init(e,t)},0)}}init(e={},t){this.isInitializing=!0,"function"==typeof e&&(t=e,e={}),null==e.defaultNS&&e.ns&&(Lr(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const n=bo();this.options=l(l(l({},n),this.options),wo(e)),this.options.interpolation=l(l({},n.interpolation),this.options.interpolation),void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator);const r=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let e;this.modules.logger?eo.init(r(this.modules.logger),this.options):eo.init(null,this.options),e=this.modules.formatter?this.modules.formatter:yo;const t=new ao(this.options);this.store=new no(this.options.resources,this.options);const o=this.services;o.logger=eo,o.resourceStore=this.store,o.languageUtils=t,o.pluralResolver=new uo(t,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),this.options.interpolation.format&&this.options.interpolation.format!==n.interpolation.format&&this.logger.warn("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),!e||this.options.interpolation.format&&this.options.interpolation.format!==n.interpolation.format||(o.formatter=r(e),o.formatter.init&&o.formatter.init(o,this.options),this.options.interpolation.format=o.formatter.format.bind(o.formatter)),o.interpolator=new fo(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new vo(r(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",(e,...t)=>{this.emit(e,...t)}),this.modules.languageDetector&&(o.languageDetector=r(this.modules.languageDetector),o.languageDetector.init&&o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=r(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new io(this.services,this.options),this.translator.on("*",(e,...t)=>{this.emit(e,...t)}),this.modules.external.forEach(e=>{e.init&&e.init(this)})}if(this.format=this.options.interpolation.format,t||(t=xo),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(e=>{this[e]=(...t)=>this.store[e](...t)}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(e=>{this[e]=(...t)=>(this.store[e](...t),this)});const o=Ir(),s=()=>{const e=(e,n)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),o.resolve(n),t(e,n)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?s():setTimeout(s,0),o}loadResources(e,t=xo){var n,r;let o=t;const s=Lr(e)?e:this.language;if("function"==typeof e&&(o=e),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===(null==s?void 0:s.toLowerCase())&&(!this.options.preload||0===this.options.preload.length))return o();const e=[],t=t=>{t&&"cimode"!==t&&this.services.languageUtils.toResolveHierarchy(t).forEach(t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)})};s?t(s):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(e=>t(e)),null==(r=null==(n=this.options.preload)?void 0:n.forEach)||r.call(n,e=>t(e)),this.services.backendConnector.load(e,this.options.ns,e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),o(e)})}else o(null)}reloadResources(e,t,n){const r=Ir();return"function"==typeof e&&(n=e,e=void 0),"function"==typeof t&&(n=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),n||(n=xo),this.services.backendConnector.reload(e,t,e=>{r.resolve(),n(e)}),r}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&ro.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1)){for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const n=Ir();this.emit("languageChanging",e);const r=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},o=(o,s)=>{s?this.isLanguageChangingTo===e&&(r(s),this.translator.changeLanguage(s),this.isLanguageChangingTo=void 0,this.emit("languageChanged",s),this.logger.log("languageChanged",s)):this.isLanguageChangingTo=void 0,n.resolve((...e)=>this.t(...e)),t&&t(o,(...e)=>this.t(...e))},s=t=>{var n,s;e||t||!this.services.languageDetector||(t=[]);const i=Lr(t)?t:t&&t[0],a=this.store.hasLanguageSomeTranslations(i)?i:this.services.languageUtils.getBestMatchFromCodes(Lr(t)?[t]:t);a&&(this.language||r(a),this.translator.language||this.translator.changeLanguage(a),null==(s=null==(n=this.services.languageDetector)?void 0:n.cacheUserLanguage)||s.call(n,a)),this.loadResources(a,e=>{o(e,a)})};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(e):s(this.services.languageDetector.detect()),n}getFixedT(e,t,n){const r=(e,t,...o)=>{let s;s="object"!=typeof t?this.options.overloadTranslationOptionHandler([e,t].concat(o)):l({},t),s.lng=s.lng||r.lng,s.lngs=s.lngs||r.lngs,s.ns=s.ns||r.ns,""!==s.keyPrefix&&(s.keyPrefix=s.keyPrefix||n||r.keyPrefix);const i=this.options.keySeparator||".";let a;return a=s.keyPrefix&&Array.isArray(e)?e.map(e=>`${s.keyPrefix}${i}${e}`):s.keyPrefix?`${s.keyPrefix}${i}${e}`:e,this.t(a,s)};return Lr(e)?r.lng=e:r.lngs=e,r.ns=t,r.keyPrefix=n,r}t(...e){var t;return null==(t=this.translator)?void 0:t.translate(...e)}exists(...e){var t;return null==(t=this.translator)?void 0:t.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const n=t.lng||this.resolvedLanguage||this.languages[0],r=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===n.toLowerCase())return!0;const s=(e,t)=>{const n=this.services.backendConnector.state[`${e}|${t}`];return-1===n||0===n||2===n};if(t.precheck){const e=t.precheck(this,s);if(void 0!==e)return e}return!(!this.hasResourceBundle(n,e)&&this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages)&&(!s(n,e)||r&&!s(o,e)))}loadNamespaces(e,t){const n=Ir();return this.options.ns?(Lr(e)&&(e=[e]),e.forEach(e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}),this.loadResources(e=>{n.resolve(),t&&t(e)}),n):(t&&t(),Promise.resolve())}loadLanguages(e,t){const n=Ir();Lr(e)&&(e=[e]);const r=this.options.preload||[],o=e.filter(e=>r.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e));return o.length?(this.options.preload=r.concat(o),this.loadResources(e=>{n.resolve(),t&&t(e)}),n):(t&&t(),Promise.resolve())}dir(e){var t,n;if(e||(e=this.resolvedLanguage||((null==(t=this.languages)?void 0:t.length)>0?this.languages[0]:this.language)),!e)return"rtl";try{const t=new Intl.Locale(e);if(t&&t.getTextInfo){const e=t.getTextInfo();if(e&&e.direction)return e.direction}}catch(o){}const r=(null==(n=this.services)?void 0:n.languageUtils)||new ao(bo());return e.toLowerCase().indexOf("-latn")>1?"ltr":["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(r.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new So(e,t)}cloneInstance(e={},t=xo){const n=e.forkResourceStore;n&&delete e.forkResourceStore;const r=l(l(l({},this.options),e),{isClone:!0}),o=new So(r);if(void 0===e.debug&&void 0===e.prefix||(o.logger=o.logger.clone(e)),["store","services","language"].forEach(e=>{o[e]=this[e]}),o.services=l({},this.services),o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},n){const e=Object.keys(this.store.data).reduce((e,t)=>(e[t]=l({},this.store.data[t]),e[t]=Object.keys(e[t]).reduce((n,r)=>(n[r]=l({},e[t][r]),n),e[t]),e),{});o.store=new no(e,r),o.services.resourceStore=o.store}return o.translator=new io(o.services,r),o.translator.on("*",(e,...t)=>{o.emit(e,...t)}),o.init(r,t),o.translator.options=r,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const No=So.createInstance();No.createInstance=So.createInstance,No.createInstance,No.dir,No.init,No.loadResources,No.reloadResources,No.use,No.changeLanguage,No.getFixedT,No.t,No.exists,No.setDefaultNamespace,No.hasLoadedNamespace,No.loadNamespaces,No.loadLanguages;No.use(zn).init({resources:{en:{translation:{widget:{title:"Chat Support",minimize:"Minimize",close:"Close",maximize:"Maximize",typing:"is typing...",online:"Online",offline:"Offline",connecting:"Connecting...",reconnecting:"Reconnecting...",sendMessage:"Send message",placeholder:"Type your message...",welcomeMessage:"Hello! How can I help you today?",startConversation:"Start Conversation",endConversation:"End Conversation",requestAgent:"Talk to Human Agent",agentJoined:"Agent has joined the conversation",agentLeft:"Agent has left the conversation",conversationEnded:"Conversation ended",fileUpload:"Upload File",voiceMessage:"Voice Message",downloadTranscript:"Download Transcript",rateConversation:"Rate this conversation",thankYou:"Thank you for your feedback!",retry:"Retry",cancel:"Cancel",send:"Send",attachFile:"Attach File",recordVoice:"Record Voice Message",stopRecording:"Stop Recording",playMessage:"Play Message",pauseMessage:"Pause Message"},errors:{connectionFailed:"Connection failed. Please try again.",messageFailed:"Failed to send message. Please try again.",fileUploadFailed:"File upload failed. Please try again.",fileTooLarge:"File is too large. Maximum size is {{maxSize}}MB.",fileTypeNotAllowed:"File type not allowed.",networkError:"Network error. Please check your connection.",sessionExpired:"Session expired. Please refresh the page.",agentUnavailable:"No agents are currently available. Please try again later.",conversationNotFound:"Conversation not found.",unauthorized:"Unauthorized access.",rateLimitExceeded:"Too many messages. Please wait a moment."},status:{connecting:"Connecting to support...",connected:"Connected",disconnected:"Disconnected",reconnecting:"Reconnecting...",waitingForAgent:"Waiting for an agent...",agentAssigned:"Agent assigned",conversationActive:"Conversation active",conversationEnded:"Conversation ended"},accessibility:{chatWidget:"Chat support widget",messageList:"Message list",messageInput:"Message input field",sendButton:"Send message button",fileUploadButton:"File upload button",voiceRecordButton:"Voice record button",minimizeButton:"Minimize chat button",closeButton:"Close chat button",newMessage:"New message received",userMessage:"Your message",botMessage:"Bot message",agentMessage:"Agent message"}}},ar:{translation:{widget:{title:"دعم الدردشة",minimize:"تصغير",close:"إغلاق",maximize:"تكبير",typing:"يكتب...",online:"متصل",offline:"غير متصل",connecting:"جاري الاتصال...",reconnecting:"إعادة الاتصال...",sendMessage:"إرسال رسالة",placeholder:"اكتب رسالتك...",welcomeMessage:"مرحباً! كيف يمكنني مساعدتك اليوم؟",startConversation:"بدء المحادثة",endConversation:"إنهاء المحادثة",requestAgent:"التحدث مع وكيل بشري",agentJoined:"انضم الوكيل إلى المحادثة",agentLeft:"غادر الوكيل المحادثة",conversationEnded:"انتهت المحادثة",fileUpload:"رفع ملف",voiceMessage:"رسالة صوتية",downloadTranscript:"تحميل النص",rateConversation:"قيم هذه المحادثة",thankYou:"شكراً لك على ملاحظاتك!",retry:"إعادة المحاولة",cancel:"إلغاء",send:"إرسال",attachFile:"إرفاق ملف",recordVoice:"تسجيل رسالة صوتية",stopRecording:"إيقاف التسجيل",playMessage:"تشغيل الرسالة",pauseMessage:"إيقاف الرسالة مؤقتاً"},errors:{connectionFailed:"فشل الاتصال. يرجى المحاولة مرة أخرى.",messageFailed:"فشل في إرسال الرسالة. يرجى المحاولة مرة أخرى.",fileUploadFailed:"فشل في رفع الملف. يرجى المحاولة مرة أخرى.",fileTooLarge:"الملف كبير جداً. الحد الأقصى للحجم هو {{maxSize}} ميجابايت.",fileTypeNotAllowed:"نوع الملف غير مسموح.",networkError:"خطأ في الشبكة. يرجى التحقق من اتصالك.",sessionExpired:"انتهت صلاحية الجلسة. يرجى تحديث الصفحة.",agentUnavailable:"لا يوجد وكلاء متاحون حالياً. يرجى المحاولة لاحقاً.",conversationNotFound:"المحادثة غير موجودة.",unauthorized:"وصول غير مصرح به.",rateLimitExceeded:"رسائل كثيرة جداً. يرجى الانتظار قليلاً."},status:{connecting:"الاتصال بالدعم...",connected:"متصل",disconnected:"منقطع",reconnecting:"إعادة الاتصال...",waitingForAgent:"في انتظار وكيل...",agentAssigned:"تم تعيين وكيل",conversationActive:"المحادثة نشطة",conversationEnded:"انتهت المحادثة"},accessibility:{chatWidget:"أداة دعم الدردشة",messageList:"قائمة الرسائل",messageInput:"حقل إدخال الرسالة",sendButton:"زر إرسال الرسالة",fileUploadButton:"زر رفع الملف",voiceRecordButton:"زر تسجيل الصوت",minimizeButton:"زر تصغير الدردشة",closeButton:"زر إغلاق الدردشة",newMessage:"تم استلام رسالة جديدة",userMessage:"رسالتك",botMessage:"رسالة البوت",agentMessage:"رسالة الوكيل"}}}},lng:"en",fallbackLng:"en",interpolation:{escapeValue:!1},react:{useSuspense:!1}});const Eo=new class{constructor(){p(this,"container",null),p(this,"root",null),p(this,"isInitialized",!1)}init(t){return h(this,null,function*(){var n;if(this.isInitialized)return;if(!t.tenantId)throw new Error("tenantId is required to initialize the chatbot widget");if(this.container=document.createElement("div"),this.container.id="chatbot-widget-container",document.body.appendChild(this.container),t.customCSS){const e=document.createElement("style");e.textContent=t.customCSS,document.head.appendChild(e)}bn.dispatch(pn({tenantId:t.tenantId,config:{apiUrl:t.apiUrl||"/api",websocketUrl:t.websocketUrl||"/ws",features:t.features,behavior:t.behavior},userId:t.userId,metadata:t.metadata}));const{aiService:r}=yield Promise.resolve().then(()=>ko),{fileService:o}=yield Promise.resolve().then(()=>Co),{proactiveService:s}=yield Promise.resolve().then(()=>Mo);r.initialize(t.apiUrl||"/api"),o.initialize(t.apiUrl||"/api"),(null==(n=t.features)?void 0:n.proactiveMessages)&&(s.setupDefaultTriggers(),s.startMonitoring()),(t.theme||t.branding||t.language||t.customCSS)&&bn.dispatch(ln({theme:t.theme||{},branding:t.branding||{},language:t.language,customCSS:t.customCSS})),this.root=b.createRoot(this.container),this.root.render(e.createElement(L,{store:bn,children:e.createElement(Dr)})),this.isInitialized=!0,"undefined"!=typeof window&&window.gtag&&window.gtag("event","chatbot_widget_initialized",{tenant_id:t.tenantId})})}destroy(){this.root&&(this.root.unmount(),this.root=null),this.container&&this.container.parentNode&&(this.container.parentNode.removeChild(this.container),this.container=null),this.isInitialized=!1}updateConfig(e){this.isInitialized&&(e.theme||e.branding||e.language||e.customCSS)&&bn.dispatch(ln({theme:e.theme||{},branding:e.branding||{},language:e.language,customCSS:e.customCSS}))}isReady(){return this.isInitialized}};"undefined"!=typeof window&&(window.ChatbotWidget=Eo),document.addEventListener("DOMContentLoaded",()=>{const e=document.querySelector("script[data-chatbot-config]");if(e)try{const t=JSON.parse(e.getAttribute("data-chatbot-config")||"{}");t.tenantId&&Eo.init(t)}catch(t){}});const Oo=new class{constructor(){p(this,"apiUrl","")}initialize(e){this.apiUrl=e}getBotResponse(e,t){return h(this,null,function*(){try{const n=yield fetch(`${this.apiUrl}/ai/chat`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e,conversationId:t})});return(yield n.json()).response}catch(n){return"I apologize, but I'm having trouble responding right now. Please try again."}})}shouldTransferToAgent(e){return h(this,null,function*(){return["human","agent","person","help","support"].some(t=>e.toLowerCase().includes(t))})}analyzeSentiment(e){return h(this,null,function*(){try{const t=yield fetch(`${this.apiUrl}/ai/sentiment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});return(yield t.json()).sentiment}catch(t){return"neutral"}})}extractIntents(e){return h(this,null,function*(){try{const t=yield fetch(`${this.apiUrl}/ai/intents`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});return(yield t.json()).intents||[]}catch(t){return[]}})}},ko=Object.freeze(Object.defineProperty({__proto__:null,aiService:Oo},Symbol.toStringTag,{value:"Module"})),jo=new class{constructor(){p(this,"apiUrl","")}initialize(e){this.apiUrl=e}uploadFile(e,t){return h(this,null,function*(){const n=new FormData;n.append("file",e),n.append("conversationId",t);try{const e=yield fetch(`${this.apiUrl}/files/upload`,{method:"POST",body:n});return(yield e.json()).fileUrl}catch(r){throw new Error("Failed to upload file")}})}isValidFileType(e,t){return t.some(t=>t.startsWith(".")?e.name.toLowerCase().endsWith(t.toLowerCase()):e.type.match(t))}isValidFileSize(e,t){return e.size<=t}formatFileSize(e){if(0===e)return"0 Bytes";const t=Math.floor(Math.log(e)/Math.log(1024));return parseFloat((e/Math.pow(1024,t)).toFixed(2))+" "+["Bytes","KB","MB","GB"][t]}getFileIcon(e){return e.startsWith("image/")?"image":e.includes("pdf")?"pdf":e.includes("word")||e.includes("document")?"document":e.includes("excel")||e.includes("spreadsheet")?"spreadsheet":"file"}},Co=Object.freeze(Object.defineProperty({__proto__:null,fileService:jo},Symbol.toStringTag,{value:"Module"})),_o=new class{constructor(){p(this,"triggers",[]),p(this,"monitoringInterval",null),p(this,"lastActivity",Date.now())}addTrigger(e,t,n=5e3){const r=`trigger_${Date.now()}_${Math.random().toString(36).substr(2,9)}`;return this.triggers.push({condition:e,message:t,delay:n,triggered:!1,id:r}),r}removeTrigger(e){this.triggers=this.triggers.filter(t=>t.id!==e)}startMonitoring(){this.monitoringInterval||(this.monitoringInterval=setInterval(()=>{this.triggers.forEach(e=>{!e.triggered&&e.condition()&&setTimeout(()=>{this.sendProactiveMessage(e.message),e.triggered=!0},e.delay)})},1e3))}stopMonitoring(){this.monitoringInterval&&(clearInterval(this.monitoringInterval),this.monitoringInterval=null)}updateActivity(){this.lastActivity=Date.now()}sendProactiveMessage(e){const t={id:`proactive_${Date.now()}`,content:e,sender:"bot",timestamp:new Date,type:"text"};bn.dispatch(Kt(t))}setupDefaultTriggers(){this.addTrigger(()=>{const e=bn.getState(),t=Date.now()-this.lastActivity;return e.chat.isOpen&&!e.chat.isTyping&&t>3e4},"Is there anything else I can help you with?",3e4),this.addTrigger(()=>{var e;const t=bn.getState();return t.chat.isOpen&&0===(null==(e=t.chat.currentConversation)?void 0:e.messages.length)},"Welcome! How can I assist you today?",2e3)}resetTriggers(){this.triggers.forEach(e=>{e.triggered=!1})}},Mo=Object.freeze(Object.defineProperty({__proto__:null,proactiveService:_o},Symbol.toStringTag,{value:"Module"}));return Eo});
